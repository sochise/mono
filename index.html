<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MONO v1.0</title>
    <link rel="icon" href="assets/logo-icon.png" type="image/png">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        // 1. MODRÉ SVĚTLO (Aktivace - Den/Práce)
                        'neuro-focus': '#0EA5E9',  // Electric Sky Blue
                        'neuro-focus-bg': '#0F172A', // Cool Slate

                        // 2. JANTAROVÝ FILTR (Regenerace - Noc/Pauza)
                        'neuro-rest': '#F59E0B',   // Bio-Amber
                        'neuro-rest-bg': '#1C1917', // Stone-900

                        // 3. ORGANIZACE
                        'neuro-admin': '#94A3B8',  // Neural Gray
                        'neuro-done': '#22C55E',   // Green

                        // Legacy mappings if needed, or keeping standard palette access
                        slate: {
                            900: '#0f172a',
                            800: '#1e293b',
                            700: '#334155',
                            50: '#f8fafc',
                        },
                        cyan: {
                            400: '#22d3ee',
                            500: '#06b6d4',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            /* Allow vertical scrolling, prevent horizontal */
            -webkit-font-smoothing: antialiased;
        }

        /* Custom Scrollbar for Parking Lot */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #1e293b;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Animations */
        @keyframes breathe {

            0%,
            100% {
                transform: scale(1);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.05);
                opacity: 1;
            }
        }

        .animate-pulse-slow {
            animation: breathe 4s ease-in-out infinite;
        }

        .slide-in-right {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }

        .slide-in-right.open {
            transform: translateX(0);
        }

        /* Box Breathing Animation */
        @keyframes breathe-box {
            0% {
                transform: scale(1);
                opacity: 0.6;
            }

            /* Inhale (4s) */
            25% {
                transform: scale(1.5);
                opacity: 1;
            }

            /* Hold (4s) */
            50% {
                transform: scale(1.5);
                opacity: 1;
            }

            /* Exhale (4s) */
            75% {
                transform: scale(1);
                opacity: 0.6;
            }

            /* Hold (4s) */
            100% {
                transform: scale(1);
                opacity: 0.6;
            }
        }

        .animate-box-breathe {
            animation: breathe-box 16s ease-in-out infinite;
            /* 4+4+4+4 = 16s cycle */
        }
    </style>
    <!-- Winter Mode Styles -->
    <style>
        .snowflake {
            position: fixed;
            top: -10px;
            color: white;
            font-size: 1em;
            font-family: Arial, sans-serif;
            text-shadow: 0 0 5px #000;
            user-select: none;
            z-index: 0;
            /* Behind main content */
            pointer-events: none;
            animation-name: snowfall;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            opacity: 0.8;
        }

        @keyframes snowfall {
            0% {
                transform: translateY(-10px) translateX(0) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 0.8;
            }

            90% {
                opacity: 0.8;
            }

            100% {
                transform: translateY(100vh) translateX(20px) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
</head>

<body
    class="bg-slate-900 text-slate-200 font-sans min-h-screen flex flex-col overflow-y-auto selection:bg-neuro-focus selection:text-white transition-colors duration-1000"
    data-theme="focus" style="overflow-y: auto !important;">
    <!-- Snow Container -->
    <div id="snow-container" class="fixed inset-0 pointer-events-none z-0"></div>

    <nav class="fixed top-0 w-full z-50 px-6 py-4 flex justify-between items-center backdrop-blur-md bg-slate-900/50 border-b border-slate-700/50 transition-all duration-300"
        id="mainNav">
        <!-- Logo -->
        <div class="flex items-center gap-4 z-50">
            <div class="w-2 h-8 bg-neuro-focus rounded-full shadow-[0_0_15px_rgba(14,165,233,0.5)]"></div>
            <h1 class="text-xl font-bold tracking-tight text-white/90">MONO <span
                    class="text-xs font-normal text-slate-400 ml-1 border border-slate-700/50 rounded-full px-2 py-0.5 bg-slate-800/50 backdrop-blur-sm hidden sm:inline-block">PF
                    2026 Edition</span></h1>
        </div>

        <!-- Desktop Navigation (Centered) -->
        <div
            class="hidden md:flex absolute left-1/2 transform -translate-x-1/2 items-center bg-slate-900/60 backdrop-blur-xl rounded-full p-2 border border-white/10 gap-2 shadow-2xl shadow-black/50 ring-1 ring-white/5">
            <button id="navFocusBtn" data-i18n="nav.app"
                class="px-6 py-2 rounded-full text-sm font-medium transition-all duration-300 bg-neuro-focus text-white shadow-[0_0_20px_rgba(14,165,233,0.3)] tracking-wide">Fokus</button>
            <button id="navBlogBtn" data-i18n="nav.blog"
                class="px-6 py-2 rounded-full text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 tracking-wide">Články</button>
            <button id="navUpdatesBtn" data-i18n="nav.docs"
                class="px-6 py-2 rounded-full text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 tracking-wide">Aktualizace</button>
            <button id="navFeedbackBtn" data-i18n="nav.feedback"
                class="px-6 py-2 rounded-full text-sm font-medium text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 tracking-wide">Zpětná
                Vazba</button>
        </div>

        <!-- Right Side Tools & Mobile Toggle -->
        <div class="flex gap-2 sm:gap-4 items-center z-50">
            <!-- Tools Group -->
            <div class="flex items-center bg-slate-800/50 rounded-full p-1 border border-slate-700/50">
                <button id="langToggle" onclick="setLanguage(currentLang === 'cs' ? 'en' : 'cs')"
                    class="w-8 h-8 flex items-center justify-center text-xs font-bold font-mono text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-full transition-colors">EN</button>
                <div class="w-px h-4 bg-slate-700 mx-1"></div>
                <button id="parkingLotToggle"
                    class="p-2 rounded-full hover:bg-slate-700/50 text-slate-400 hover:text-neuro-focus transition-all relative group"
                    title="Parking Lot">
                    <!-- Ping Animation -->
                    <span class="absolute top-2 right-2 flex h-2 w-2">
                        <span
                            class="animate-ping absolute inline-flex h-full w-full rounded-full bg-neuro-focus opacity-0 group-hover:opacity-75"></span>
                        <span
                            class="relative inline-flex rounded-full h-2 w-2 bg-neuro-focus hidden group-hover:block"></span>
                    </span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="21 8 21 21 3 21 3 8"></polyline>
                        <rect x="1" y="3" width="22" height="5"></rect>
                        <line x1="10" y1="12" x2="14" y2="12"></line>
                    </svg>
                </button>
                <button id="sessionLogToggle"
                    class="p-2 rounded-full hover:bg-slate-700/50 text-slate-400 hover:text-cyan-400 transition-all"
                    title="Session Log"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg></button>
                <button id="helpToggle"
                    class="p-2 rounded-full hover:bg-slate-700/50 text-slate-400 hover:text-emerald-400 transition-all"
                    title="Nápověda & Techniky"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                        viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg></button>
            </div>

            <!-- Mobile Menu Button -->
            <button id="mobileMenuBtn" class="md:hidden p-2 text-slate-300 hover:text-white transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="w-8 h-8">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu Overlay -->
    <div id="mobileMenuOverlay"
        class="fixed inset-0 bg-slate-900/95 backdrop-blur-xl z-40 hidden flex flex-col justify-center items-center gap-8 md:hidden transition-all duration-300 opacity-0">
        <button id="mobNavFocus" class="text-2xl font-bold text-white hover:text-neuro-focus transition-colors"
            data-i18n="nav.app">Fokus</button>
        <button id="mobNavBlog" class="text-2xl font-bold text-slate-400 hover:text-white transition-colors"
            data-i18n="nav.blog">Články</button>
        <button id="mobNavUpdates" class="text-2xl font-bold text-slate-400 hover:text-white transition-colors"
            data-i18n="nav.docs">Aktualizace</button>
        <button id="mobNavFeedback" class="text-2xl font-bold text-slate-400 hover:text-white transition-colors"
            data-i18n="nav.feedback">Zpětná Vazba</button>

        <div class="w-12 h-1 bg-slate-800 rounded-full my-4"></div>

        <p class="text-slate-500 text-sm font-mono">MONO v1.1</p>
    </div>
    <!-- Parking Lot Overlay -->
    <div id="parkingLotOverlay"
        class="fixed inset-y-0 right-0 w-full md:w-96 bg-slate-800 shadow-2xl z-50 slide-in-right border-l border-slate-700 flex flex-col p-6">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-xl font-semibold text-neuro-focus" data-i18n="parking.title">Parkoviště myšlenek</h2><button
                id="closeParkingLot" class="text-neuro-admin hover:text-white transition-colors"><svg
                    xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg></button>
        </div>
        <p class="text-sm text-neuro-admin mb-4" data-i18n="parking.subtitle">Rušivá myšlenka? Odložte si ji sem a
            vraťte se k práci.</p>
        <div class="flex gap-2 mb-6"><input type="text" id="thoughtInput" placeholder="Napište myšlenku..."
                data-i18n="parking.placeholder"
                class="flex-1 bg-neuro-focus-bg border border-slate-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:border-neuro-focus focus:ring-1 focus:ring-neuro-focus transition-all"><button
                id="addThoughtBtn" data-i18n="parking.addBtn"
                class="bg-neuro-focus text-white px-4 py-2 rounded-lg hover:brightness-110 transition-colors font-medium">Uložit</button>
        </div>
        <ul id="thoughtsList" class="flex-1 overflow-y-auto custom-scrollbar space-y-3">
            <!-- Dynamic thoughts will be added here -->
        </ul>
    </div>
    <!-- Session Log Overlay -->
    <div id="sessionLogOverlay"
        class="fixed inset-y-0 left-0 w-full md:w-96 bg-slate-800 shadow-2xl z-50 transform -translate-x-full transition-transform duration-300 ease-in-out border-r border-slate-700 flex flex-col p-6">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-xl font-semibold text-neuro-focus" data-i18n="sessionLog.title">Historie Relace</h2><button
                id="closeSessionLog" class="text-neuro-admin hover:text-white transition-colors"><svg
                    xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg></button>
        </div>
        <p class="text-sm text-neuro-admin mb-4" data-i18n="sessionLog.subtitle">Přehled dokončených úkolů v této relaci
            (vymaže se po zavření
            prohlížeče).</p>
        <div class="bg-slate-900/50 p-4 rounded-xl border border-slate-700 mb-6">
            <div class="text-neuro-admin text-xs uppercase tracking-wider mb-1" data-i18n="sessionLog.totalTime">Celkový
                čas soustředění</div>
            <div id="totalFocusTime" class="text-3xl font-mono font-bold text-neuro-focus">00: 00</div>
        </div>
        <ul id="sessionLogList" class="flex-1 overflow-y-auto custom-scrollbar space-y-3">
            <!-- Dynamic session items will be added here -->
        </ul>
    </div>
    <!-- Help Overlay -->
    <div id="helpOverlay"
        class="fixed inset-0 bg-slate-900/95 backdrop-blur-sm z-[60] hidden flex items-center justify-center p-4">
        <div
            class="bg-slate-800 w-full max-w-4xl max-h-[90vh] rounded-2xl shadow-2xl overflow-hidden flex flex-col border border-slate-700">
            <div class="p-6 border-b border-slate-700 flex justify-between items-center bg-slate-800">
                <h2 class="text-2xl font-bold text-white flex items-center gap-2"> <img src="assets/logo-icon.png"
                        alt="Logo" class="w-8 h-8 rounded-md"> <span data-i18n="help.title">Průvodce MONO</span>
                </h2>
                <div class="flex items-center gap-4"> <a href="documentation.html" target="_blank"
                        class="text-sm font-medium text-neuro-focus hover:text-white transition-colors"
                        data-i18n="help.menu">
                        Manuál</a> <button id="closeHelp"
                        class="p-2 hover:bg-slate-700 rounded-full transition-colors text-neuro-admin hover:text-neuro-focus">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg> </button> </div>
            </div>
            <div class="flex-1 overflow-y-auto custom-scrollbar p-6 space-y-12">
                <article id="filosofie" class="mb-20 scroll-mt-32">
                    <h2 class="text-3xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-neuro-focus">01.</span> <span
                            data-i18n="help.sections.philosophy.title">Filosofie Designu</span>
                    </h2>
                    <div class="prose prose-invert max-w-none text-slate-300 leading-7">
                        <p data-i18n="help.sections.philosophy.text1">
                            Většina "to-do" aplikací vás zahlcuje seznamy úkolů. <strong>MONO je jiný.</strong> Je to
                            "Attention Management System" (Systém řízení pozornosti).
                            Jeho cílem není, abyste toho "stihli více", ale abyste dělali <strong>to podstatné v hlubším
                                soustředění</strong>.
                        </p>
                        <div class="bg-slate-800/50 border-l-4 border-neuro-focus p-6 my-6 rounded-r-lg">
                            <p class="italic mb-2 text-white" data-i18n="help.sections.philosophy.quote">"Skutečná
                                produktivita není o rychlosti, ale o jasnosti
                                mysli a
                                zdravém rytmu."</p>
                        </div>
                        <p data-i18n="help.sections.philosophy.text2">
                            Aplikace respektuje vaše neurobiologické limity. Využívá <strong
                                class="text-neuro-focus">Ultragdiánní rytmy</strong> (90 min aktivity) a automaticky vás
                            nutí k
                            odpočinku dříve, než se vyčerpají vaše zásoby dopaminu.
                        </p>
                    </div>
                </article>

                <article id="cyklus" class="mb-20 scroll-mt-32">
                    <h2 class="text-3xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-neuro-focus">02.</span> <span
                            data-i18n="help.sections.workflow.title">Pracovní Cyklus</span>
                    </h2>
                    <div class="grid gap-8">
                        <div
                            class="bg-neuro-card p-6 rounded-xl border border-slate-700 hover:border-neuro-focus transition-colors group">
                            <div class="text-neuro-focus font-bold mb-2 text-lg"
                                data-i18n="help.sections.workflow.prep.title">Fáze 1: Příprava (Prep)</div>
                            <p class="text-slate-400" data-i18n="help.sections.workflow.prep.text">
                                Mozek potřebuje jasný záměr. V této fázi definujete <strong>JEDEN úkol</strong>. Žádné
                                seznamy.
                                Zde si také nastavíte zvukovou kulisu (YouTube) a časovač (doporučeno 25-50 min).
                            </p>
                        </div>
                        <div
                            class="bg-neuro-card p-6 rounded-xl border border-slate-700 hover:border-neuro-focus transition-colors group">
                            <div class="text-neuro-focus font-bold mb-2 text-lg"
                                data-i18n="help.sections.workflow.flow.title">Fáze 2: Práce (Flow)</div>
                            <p class="text-slate-400" data-i18n="help.sections.workflow.flow.text">
                                Vše zmizí. Zůstává jen odpočet a váš úkol.
                                Využijte <strong>Parkoviště myšlenek</strong> (vpravo nahoře) pro odložení rušivých
                                nápadů, aniž
                                byste opustili kontext.
                            </p>
                        </div>
                        <div
                            class="bg-neuro-card p-6 rounded-xl border border-slate-700 hover:border-neuro-rest transition-colors group">
                            <div class="text-neuro-rest font-bold mb-2 text-lg"
                                data-i18n="help.sections.workflow.regen.title">Fáze 3: Regenerace (Regen)</div>
                            <p class="text-slate-400" data-i18n="help.sections.workflow.regen.text">
                                Po skončení časovače se aplikace přepne do Jantarového módu. Nyní <strong>nesmíte
                                    pracovat</strong>.
                                Aplikace vám nabídne techniky jako NSDR, Box Breathing nebo Mikro-pohyb pro obnovu
                                kognitivních
                                zdrojů.
                            </p>
                        </div>
                    </div>
                </article>

                <article id="funkce" class="mb-20 scroll-mt-32">
                    <h2 class="text-3xl font-bold text-white mb-8 flex items-center gap-3">
                        <span class="text-neuro-focus">03.</span> <span data-i18n="help.sections.features.title">Klíčové
                            Funkce</span>
                    </h2>

                    <div class="space-y-12">
                        <!-- Main Screen -->
                        <div class="bg-neuro-card rounded-xl border border-slate-700 overflow-hidden">
                            <img src="assets/docs_main_view.png" alt="Hlavní obrazovka"
                                class="w-full border-b border-slate-700/50">
                            <div class="p-8">
                                <h3 class="text-2xl text-white font-bold mb-3"
                                    data-i18n="help.sections.features.focus.title">Hlavní Panel (Fokus)</h3>
                                <p class="text-slate-400 mb-4" data-i18n="help.sections.features.focus.text">
                                    Centrální místo pro vaši práci. Zadejte <strong>JEDEN úkol</strong> ("The One
                                    Thing"),
                                    nastavte délku bloku (25/50/90 min) a zvolte soundtrack.
                                    Jednoduchost je záměrná – nic vás nesmí rozptylovat. Cirkadiánní logika automaticky
                                    upravuje
                                    barevné schéma podle denní doby (po 18:00 se aktivuje Jantarový mód).
                                </p>
                            </div>
                        </div>

                        <!-- Blog -->
                        <div class="bg-neuro-card rounded-xl border border-slate-700 overflow-hidden">
                            <img src="assets/docs_blog_view.png" alt="Blog a Edukace"
                                class="w-full border-b border-slate-700/50">
                            <div class="p-8">
                                <h3 class="text-2xl text-white font-bold mb-3"
                                    data-i18n="help.sections.features.blog.title">Neuro-Insights (Blog)</h3>
                                <p class="text-slate-400 mb-4" data-i18n="help.sections.features.blog.text">
                                    Pochopte "proč". Sekce článků vysvětluje vědecké podklady našich technik (Hnědý šum,
                                    NSDR,
                                    Cirkadiánní rytmy).
                                    Přepínejte mezi Fokusem a Články pomocí nového navigačního menu nahoře.
                                </p>
                            </div>
                        </div>

                        <!-- Tools Grid -->
                        <div class="grid md:grid-cols-2 gap-8">
                            <!-- Parking Lot -->
                            <div class="bg-neuro-card rounded-xl border border-slate-700 overflow-hidden flex flex-col">
                                <img src="assets/docs_parking_view.png" alt="Parkoviště myšlenek"
                                    class="w-full h-48 object-cover object-top border-b border-slate-700/50">
                                <div class="p-6 flex-1">
                                    <h3 class="text-xl text-white font-bold mb-2"
                                        data-i18n="help.sections.features.parking.title">Parkoviště Myšlenek</h3>
                                    <p class="text-slate-400 text-sm" data-i18n="help.sections.features.parking.text">
                                        Externí paměť pro vaše nápady. Když vás při práci něco napadne, neotvírejte
                                        novou
                                        záložku.
                                        Zapište to sem (ikona krabice vpravo nahoře) a okamžitě se vraťte k práci.
                                    </p>
                                </div>
                            </div>

                            <!-- Session Log -->
                            <div class="bg-neuro-card rounded-xl border border-slate-700 overflow-hidden flex flex-col">
                                <img src="assets/docs_session_view.png" alt="Historie Relace"
                                    class="w-full h-48 object-cover object-top border-b border-slate-700/50">
                                <div class="p-6 flex-1">
                                    <h3 class="text-xl text-white font-bold mb-2"
                                        data-i18n="help.sections.features.log.title">Historie Relace</h3>
                                    <p class="text-slate-400 text-sm" data-i18n="help.sections.features.log.text">
                                        Sledujte svůj postup. Zobrazuje dokončené bloky a celkový čas soustředění v dané
                                        seanci.
                                        Data se resetují při zavření prohlížeče (podporuje "čistý štít" každý den).
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </article>

                <article id="youtube" class="mb-20 scroll-mt-32">
                    <h2 class="text-3xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-neuro-focus">04.</span> <span data-i18n="help.sections.youtube.title">YouTube
                            Integrace</span>
                    </h2>
                    <div class="bg-neuro-card p-8 rounded-xl border border-slate-700">
                        <p class="text-slate-300 mb-6">
                            <span data-i18n="help.sections.youtube.text">MONO přímo integruje YouTube přehrávač pro vaše
                                focus playlisty. Video se automaticky:</span>
                        <ul class="list-disc pl-5 mt-2 space-y-1">
                            <li data-i18n="help.sections.youtube.list1"><strong>Spustí</strong> při startu časovače.
                            </li>
                            <li data-i18n="help.sections.youtube.list2"><strong>Zastaví</strong> při pauze nebo konci
                                bloku.</li>
                        </ul>
                        </p>

                        <h3 class="text-lg font-semibold text-white mb-2" data-i18n="help.sections.youtube.channels">
                            Doporučené Kanály:</h3>
                        <ul class="list-disc pl-5 text-slate-400 space-y-2 mb-6">
                            <li data-i18n="help.sections.youtube.channelsList.lofi"><strong>Lofi Girl</strong> - pro
                                studium a rutinní práci.</li>
                            <li data-i18n="help.sections.youtube.channelsList.endel"><strong>Endel</strong> - vědecky
                                navržené zvukové krajiny.</li>
                            <li data-i18n="help.sections.youtube.channelsList.brainfm"><strong>Brain.fm</strong> - pro
                                intenzivní kognitivní výkon.</li>
                        </ul>

                        <div class="bg-yellow-500/10 border-l-4 border-yellow-500 p-4 rounded-r">
                            <h4 class="text-yellow-500 font-bold mb-1" data-i18n="help.sections.youtube.error">Důležité:
                                YouTube Error 150/153</h4>
                            <p class="text-sm text-yellow-200/80" data-i18n="help.sections.youtube.errorText">
                                Některá videa (např. VEVO hudba) nejdou přehrát mimo YouTube. Pokud se video nenačte,
                                zkuste
                                najít "No Copyright" verzi nebo jiný kanál.
                                Také se ujistěte, že aplikaci spouštíte přes <strong>server</strong> (viz níže), ne jako
                                soubor.
                            </p>
                        </div>
                    </div>
                </article>

                <article id="tech" class="mb-20 scroll-mt-32">
                    <h2 class="text-3xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-neuro-focus">05.</span> <span data-i18n="help.sections.deploy.title">Nasazení
                            & Spouštění</span>
                    </h2>

                    <div class="space-y-8">
                        <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700">
                            <h3 class="text-xl text-white font-semibold mb-3"
                                data-i18n="help.sections.deploy.online.title">Online (Doporučeno)</h3>
                            <p class="text-slate-400 mb-3" data-i18n="help.sections.deploy.online.text">
                                Pro bezproblémové fungování YouTube API doporučujeme aplikaci nahrát na statický
                                hosting.
                                Není potřeba žádný backend.
                            </p>
                            <ul class="list-disc pl-5 text-slate-400 space-y-2">
                                <li data-i18n="help.sections.deploy.online.list.netlify"><strong>Netlify Drop:</strong>
                                    Pouze přetáhněte složku projektu do prohlížeče.</li>
                                <li data-i18n="help.sections.deploy.online.list.github"><strong>GitHub Pages:</strong>
                                    Nasazení přímo z repozitáře (v Nastavení -> Pages).
                                </li>
                            </ul>
                        </div>

                        <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700">
                            <h3 class="text-xl text-white font-semibold mb-3"
                                data-i18n="help.sections.deploy.local.title">Lokální Vývoj</h3>
                            <p class="text-slate-400 mb-3" data-i18n="help.sections.deploy.local.text">
                                Pokud spouštíte aplikaci lokálně, <strong>neotevírejte</strong> <code>index.html</code>
                                dvojklikem.
                                YouTube API vyžaduje protokol HTTP/HTTPS.
                            </p>
                            <div
                                class="bg-black/50 p-4 rounded-lg font-mono text-sm text-green-400 border border-slate-800 mb-2">
                                python3 -m http.server 8000
                            </div>
                            <p class="text-slate-500 text-sm">Adresa: <a href="http://localhost:8000"
                                    class="text-neuro-focus hover:underline">http://localhost:8000</a></p>
                        </div>

                        <div>
                            <h3 class="text-xl text-white font-semibold mb-3"
                                data-i18n="help.sections.deploy.data.title">Data a Soukromí</h3>
                            <p class="text-slate-400" data-i18n="help.sections.deploy.data.text">
                                Všechna data jsou ukládána <strong>pouze ve vašem prohlížeči</strong> (LocalStorage).
                                Aplikace funguje 100% offline (kromě YouTube funkcionality).
                            </p>
                        </div>
                    </div>
                </article>
                <!-- Section: Techniques List (Dynamic) -->
                <div class="space-y-6 pt-12 border-t border-slate-700">
                    <h3 class="text-xl font-semibold text-emerald-400" data-i18n="help.sections.techniques.title">
                        Přehled Implementovaných Technik</h3>
                    <div id="techniquesList" class="grid md:grid-cols-2 gap-4">
                        <!-- Dynamic techniques will be added here by JS -->
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!-- Main Content Area -->
    <main id="app" class="flex-1 flex flex-col items-center justify-center p-6 z-10 relative pt-24">
        <!-- Preparation Phase -->
        <section id="prepPhase" class="w-full max-w-2xl text-center space-y-12 transition-opacity duration-500">
            <div class="space-y-4">
                <h1
                    class="text-6xl md:text-8xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white via-slate-200 to-slate-400 mb-2 tracking-tight">
                    MONO</h1>
                <div
                    class="inline-block px-3 py-1 rounded-full bg-slate-800/80 border border-slate-700/50 mb-6 backdrop-blur-md">
                    <span class="text-xs font-mono text-cyan-300 tracking-widest uppercase">✨ PF
                        2026 Edition ✨</span>
                </div>
            </div>
            <p class="text-emerald-400 text-sm font-medium tracking-wide mb-6" data-i18n="hero.tagline"> Nástroj pro
                přechod od nestíhání k monotaskingu. </p>
            <p class="text-slate-400 text-lg tracking-wide" data-i18n="hero.subtagline">Definujte svůj záměr.</p>
            </div>
            <div class="space-y-8 bg-slate-800/50 p-10 rounded-3xl border border-slate-700/50 shadow-2xl backdrop-blur-sm"
                style="box-shadow: 0 0 40px -10px rgba(6, 182, 212, 0.15);">
                <div class="space-y-2 text-left"> <label data-i18n="prep.goalLabel"
                        class="text-xs uppercase tracking-widest text-neuro-focus font-semibold ml-1">The
                        One Thing</label> <input type="text" id="taskInput" data-i18n="prep.goalPlaceholder"
                        class="w-full bg-slate-900/80 border-2 border-slate-700 rounded-xl px-6 py-4 text-xl text-white placeholder-slate-600 focus:outline-none focus:border-neuro-focus focus:ring-4 focus:ring-neuro-focus/20 transition-all"
                        placeholder="Na čem budete pracovat?" autocomplete="off"> </div>
                <div class="space-y-2 text-left"> <label data-i18n="prep.timeLabel"
                        class="text-xs uppercase tracking-widest text-neuro-focus font-semibold ml-1">Časový
                        blok (min)</label>
                    <div class="flex items-center gap-4"> <button
                            class="time-preset px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-sm transition-colors"
                            data-time="25">25</button> <button
                            class="time-preset px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-sm transition-colors"
                            data-time="50">50</button> <button
                            class="time-preset px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 text-sm transition-colors"
                            data-time="90">90</button> <input type="number" id="timeInput"
                            class="w-24 bg-slate-900/80 border-2 border-slate-700 rounded-xl px-4 py-2 text-xl text-center text-white focus:outline-none focus:border-neuro-focus transition-all"
                            min="1" max="180" step="1"> </div>
                </div>
                <div class="space-y-2 text-left"> <label data-i18n="prep.youtubeLabel"
                        class="text-xs uppercase tracking-widest text-neuro-focus font-semibold ml-1">Soundtrack
                        (YouTube URL)</label>
                    <div class="relative"> <input type="text" id="ytUrlInput"
                            class="w-full bg-slate-900/80 border-2 border-slate-700 rounded-xl px-6 py-4 pr-12 text-sm text-white placeholder-slate-600 focus:outline-none focus:border-neuro-focus focus:ring-4 focus:ring-neuro-focus/20 transition-all font-mono"
                            placeholder="https://youtube.com/watch?v=...">
                        <div class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-500 pointer-events-none">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path
                                    d="M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17">
                                </path>
                                <path d="m10 15 5-3-5-3z"></path>
                            </svg>
                        </div>
                    </div>
                    <div id="ytPreview"
                        class="mt-4 hidden aspect-video w-full rounded-xl overflow-hidden shadow-lg border border-slate-700 bg-slate-900">
                        <!-- Preview iframe will be injected here -->
                    </div>
                </div> <button id="startBtn"
                    class="w-full group relative overflow-hidden bg-gradient-to-r from-neuro-focus to-blue-600 text-white font-bold py-5 px-8 rounded-xl transition-all hover:shadow-[0_0_40px_-5px_rgba(14,165,233,0.5)] transform hover:-translate-y-1">
                    <span class="relative z-10 flex items-center justify-center gap-2 text-lg">
                        <span data-i18n="prep.startBtn">Vstoupit do Zóny</span> <svg xmlns="http://www.w3.org/2000/svg"
                            width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="group-hover:translate-x-1 transition-transform">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg> </span> </button>
            </div>
        </section>
        <!-- Work Phase (Flow) -->
        <section id="workPhase" class="hidden w-full h-full flex flex-col items-center justify-center min-h-[80vh]">
            <!-- Timer & SVG Visualizer -->
            <!-- Timer & SVG Visualizer -->
            <div class="relative w-80 h-80 md:w-[32rem] md:h-[32rem] flex items-center justify-center mb-8">
                <!-- SVG Ring --> <svg
                    class="absolute inset-0 w-full h-full transform -rotate-90 pointer-events-none drop-shadow-xl"
                    viewBox="0 0 100 100">
                    <!-- Background Ring -->
                    <circle cx="50" cy="50" r="45" fill="none" class="stroke-slate-800/30" stroke-width="1.5"></circle>
                    <!-- Progress Ring -->
                    <circle id="timerProgress" cx="50" cy="50" r="45" fill="none"
                        class="stroke-neuro-focus transition-[stroke-dashoffset] duration-1000 ease-linear shadow-[0_0_15px_rgba(14,165,233,0.3)]"
                        stroke-width="1.5" stroke-linecap="round" stroke-dasharray="283" stroke-dashoffset="0">
                    </circle>
                </svg>
                <!-- Digital Display Only -->
                <div class="z-10 text-center flex flex-col items-center">
                    <div id="timerDisplay"
                        class="text-7xl md:text-8xl font-light text-white tracking-widest tabular-nums select-none"
                        style="text-shadow: 0 0 30px rgba(14,165,233,0.3);">
                        25:00 </div>
                </div>
            </div>
            <!-- Task Display (Below Ring) -->
            <div id="currentTaskDisplay"
                class="text-xl md:text-2xl text-neuro-focus/80 font-light tracking-wide max-w-lg text-center truncate mb-12 min-h-[2rem]">
                <!-- Task Name Here -->
            </div>
            <!-- Controls -->
            <div class="flex items-center gap-8 relative z-[60]">
                <!-- Noise Toggle --> <button id="noiseBtn" onclick="toggleNoise()"
                    class="group p-4 rounded-full bg-slate-800/80 border border-slate-700 text-slate-400 hover:text-neuro-focus hover:border-neuro-focus/50 transition-all duration-300 backdrop-blur-sm"
                    title="Brown Noise">
                    <div class="relative w-8 h-8"> <svg id="noiseIconOff" xmlns="http://www.w3.org/2000/svg"
                            class="w-full h-full absolute inset-0 transition-opacity duration-300" viewBox="0 0 24 24"
                            fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path
                                d="M2 12c.6 0 1.2.4 1.5 1 .3.6.9.6 1.2 0 .3-.6.9-1 1.5-1s1.2.4 1.5 1c.3.6.9.6 1.2 0 .3-.6.9-1 1.5-1s1.2.4 1.5 1c.3.6.9.6 1.2 0 .3-.6.9-1 1.5-1s1.2.4 1.5 1c.3.6.9.6 1.2 0 .3-.6.9-1 1.5-1">
                            </path>
                            <line x1="2" y1="22" x2="22" y2="2" class="opacity-50"></line>
                        </svg> <svg id="noiseIconOn" xmlns="http://www.w3.org/2000/svg"
                            class="w-full h-full absolute inset-0 hidden text-neuro-focus filter drop-shadow-[0_0_8px_rgba(14,165,233,0.8)]"
                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M2 12c.6 0 1.2.4 1.5 1 .3.6.9.6 1.2 0 .3-.6.9-1 1.5-1s1.2.4 1.5 1c.3.6.9.6 1.2 0 .3-.6.9-1 1.5-1s1.2.4 1.5 1c.3.6.9.6 1.2 0 .3-.6.9-1 1.5-1s1.2.4 1.5 1c.3.6.9.6 1.2 0 .3-.6.9-1 1.5-1">
                            </path>
                        </svg> </div>
                </button>
                <!-- Play/Pause (Primary) --> <button id="toggleTimerBtn" onclick="toggleTimer()"
                    class="p-8 rounded-full bg-white text-black shadow-[0_0_30px_rgba(255,255,255,0.2)] hover:shadow-[0_0_50px_rgba(255,255,255,0.4)] hover:scale-105 transition-all duration-300">
                    <svg id="playIcon" xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 ml-1 hidden"
                        viewBox="0 0 24 24" fill="currentColor" stroke="none">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg> <svg id="pauseIcon" xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" viewBox="0 0 24 24"
                        fill="currentColor" stroke="none">
                        <rect x="6" y="4" width="4" height="16"></rect>
                        <rect x="14" y="4" width="4" height="16"></rect>
                    </svg> </button>
                <!-- Stop (Secondary) --> <button id="stopBtn" onclick="stopSession()"
                    class="group p-4 rounded-full bg-slate-800/80 border border-slate-700 text-slate-400 hover:text-red-400 hover:border-red-500/50 transition-all duration-300 backdrop-blur-sm"
                    title="Ukončit" data-i18n="work.stop">
                    <div class="relative w-8 h-8"> <svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full"
                            viewBox="0 0 24 24" fill="currentColor" stroke="none">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        </svg> </div>
                </button>
            </div>
            <!-- YouTube Mini Player (Work Phase) -->
            <div id="ytWorkPlayer"
                class="hidden fixed bottom-24 right-4 md:bottom-8 md:right-8 w-48 md:w-80 aspect-video rounded-xl overflow-hidden shadow-2xl border border-slate-700/50 transition-all hover:scale-105 hover:opacity-100 opacity-80 md:opacity-60 z-50 group">
                <!-- Active iframe will be injected here by API replacing
                                                                the inner div -->
                <div id="ytPlayerFrame"></div>
                <div
                    class="absolute inset-x-0 bottom-0 h-8 bg-gradient-to-t from-black/80 to-transparent pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-center pb-2">
                    <span class="text-[10px] text-white/50 uppercase tracking-wider">Background
                        Audio</span>
                </div>
            </div>
            </div>
        </section>
        <!-- Break Phase (Regen) - Instruction View -->
        <section id="breakPhase" class="hidden w-full max-w-3xl text-center space-y-12">
            <div id="regenInstructionView" class="space-y-8 animate-fade-in">
                <div class="space-y-4">
                    <h2 class="text-4xl font-light text-neuro-rest" data-i18n="break.title">Neuro-Regenerace</h2>
                    <p class="text-neuro-admin text-xl" data-i18n="break.subtitle">Doplňte dopamin pro další cyklus.
                    </p>
                </div>
                <div
                    class="bg-slate-800/80 p-10 rounded-3xl border border-neuro-rest/30 shadow-[0_0_50px_-15px_rgba(245,158,11,0.2)]">
                    <div class="mb-8">
                        <div class="inline-block p-4 bg-neuro-rest/10 rounded-full mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                stroke-linejoin="round" class="text-neuro-rest">
                                <path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z">
                                </path>
                                <path d="m9 12 2 2 4-4"></path>
                            </svg>
                        </div>
                        <h3 id="breakActivityTitle" class="text-2xl font-bold text-white mb-2">Non-Sleep Deep Rest
                        </h3>
                        <p id="breakActivityDesc" class="text-lg text-neuro-admin leading-relaxed"> Zavřete oči a
                            soustřeďte se pouze na dech. Uvolněte čelist a ramena. </p>
                        <p id="breakActivityDuration"
                            class="text-neuro-rest mt-2 font-mono text-sm uppercase tracking-widest">
                            Doporučený čas: 10:00</p>
                    </div>
                    <div class="grid grid-cols-2 gap-4"> <button id="startBreakBtn" data-i18n="break.startBtn"
                            class="bg-neuro-rest hover:bg-neuro-rest/90 text-white font-bold py-4 px-6 rounded-xl transition-all shadow-lg hover:shadow-neuro-rest/50">
                            Spustit cvičení </button> <button id="skipBreakBtn" data-i18n="break.skipBtn"
                            class="bg-slate-700 hover:bg-slate-600 text-slate-300 hover:text-white font-medium py-4 px-6 rounded-xl transition-all">
                            Přeskočit </button> </div>
                </div>
            </div>
            <!-- Break Phase (Regen) - Active View -->
            <div id="regenActiveView" class="hidden space-y-12 animate-fade-in flex flex-col items-center">
                <h2 id="activeBreakTitle" class="text-3xl font-light text-neuro-rest">
                    Box Breathing</h2>
                <!-- Visualizer for Breathing/Timer -->
                <div class="relative flex items-center justify-center w-80 h-80">
                    <!-- Circle that animates -->
                    <div id="visualizerCircle"
                        class="w-48 h-48 rounded-full bg-neuro-rest/20 border-2 border-neuro-rest/50 transition-all duration-1000">
                    </div>
                    <div id="breakTimerDisplay" class="absolute text-5xl font-mono font-bold text-white drop-shadow-lg">
                        04:00 </div>
                </div> <button id="finishBreakBtn" data-i18n="break.finishBtn"
                    class="text-slate-400 hover:text-white border-b border-transparent hover:border-white transition-colors pb-1">
                    Ukončit cvičení </button>
            </div>
        </section>
    </main>
    <!-- Blog Section -->
    <section id="blogSection"
        class="hidden fixed inset-0 w-full h-screen overflow-y-auto pt-24 px-4 pb-12 z-20 bg-slate-900/95 backdrop-blur-sm">
        <div class="max-w-4xl mx-auto">
            <header class="mb-16 text-center animate-fade-in">
                <h1 class="text-5xl font-light text-white tracking-tight mb-4">Neuro <span
                        class="text-neuro-focus">Insights</span></h1>
                <p class="text-neuro-admin text-lg max-w-2xl mx-auto" data-i18n="blog.subtitle">Optimalizace
                    kognitivního
                    výkonu pomocí vědy,
                    technologie a designu.</p>
            </header>
            <div id="articleList" class="grid gap-8 animate-fade-in-up">
                <!-- Article Cards generated by JS -->
            </div>
            <div id="articleDetail" class="hidden animate-fade-in"> <button id="backToArticlesBtn"
                    class="flex items-center gap-2 text-slate-400 hover:text-white mb-8 transition-colors group">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="group-hover:-translate-x-1 transition-transform">
                        <polyline points="15 18 9 12 15 6"></polyline>
                    </svg> <span data-i18n="blog.back">Zpět na přehled</span> </button>
                <article id="articleContent" class="prose prose-invert prose-lg max-w-none">
                    <!-- Content injected by JS -->
                </article>
            </div>
        </div>
    </section>
    <!-- UPDATES SECTION -->
    <section id="updatesSection"
        class="hidden fixed inset-0 w-full h-screen overflow-y-auto pt-32 pb-20 px-6 max-w-4xl mx-auto z-10 relative bg-slate-900/95 backdrop-blur-sm">
        <div class="mb-12">
            <h1 class="text-4xl font-bold text-white mb-2" data-i18n="updates.title">Aktualizace</h1>
            <p class="text-slate-400" data-i18n="updates.subtitle">Přehled novinek a změn v aplikaci MONO.</p>
        </div>
        <div class="space-y-12 border-l border-slate-800 pl-8 ml-4">
            <!-- v1.1 Polishing -->
            <div class="relative">
                <div class="absolute -left-[41px] top-1 w-5 h-5 rounded-full bg-cyan-400 border-4 border-slate-900">
                </div>
                <h2 class="text-2xl font-bold text-white mb-2 flex items-center gap-3"> MONO
                    v1.1 <span
                        class="text-xs bg-cyan-400/20 text-cyan-400 px-2 py-0.5 rounded-full font-mono">Latest</span>
                </h2>
                <div class="text-sm text-slate-500 mb-6 font-mono" data-i18n="updates.v1_1.date">31. Prosince 2025</div>
                <div class="space-y-6">
                    <div class="bg-slate-800/40 p-6 rounded-xl border border-slate-700/50">
                        <h3 class="font-bold text-lg text-white mb-3" data-i18n="updates.v1_1.title">✨ Feedback &
                            Ladění</h3>
                        <p class="text-slate-400 mb-4" data-i18n="updates.v1_1.desc">Přidána možnost zpětné vazby a
                            opravy v překladech.</p>
                        <ul class="list-disc pl-5 text-slate-400 space-y-1">
                            <li data-i18n="updates.v1_1.list.feedback"><span class="text-pink-400">Zpětná
                                    Vazba:</span> Nová sekce pro vaše nápady.</li>
                            <li data-i18n="updates.v1_1.list.fixes"><span class="text-indigo-400">Fixes:</span>
                                Opraveno vykreslování HTML tagů v překladech.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- v1.0 MONO -->
            <div class="relative">
                <div class="absolute -left-[41px] top-1 w-5 h-5 rounded-full bg-neuro-focus border-4 border-slate-900">
                </div>
                <h2 class="text-2xl font-bold text-white mb-2 flex items-center gap-3"> MONO
                    v1.0 <span
                        class="text-xs bg-neuro-focus/20 text-neuro-focus px-2 py-0.5 rounded-full font-mono">Released</span>
                </h2>
                <div class="text-sm text-slate-500 mb-6 font-mono" data-i18n="updates.v1.date">23. Prosince 2025</div>
                <div class="space-y-6">
                    <div class="bg-slate-800/40 p-6 rounded-xl border border-slate-700/50">
                        <h3 class="font-bold text-lg text-white mb-3" data-i18n="updates.v1.upgrade.title">🚀 Rebranding
                            &
                            Upgrade</h3>
                        <p class="text-slate-400 mb-4" data-i18n="updates.v1.upgrade.text">Aplikace nyní nese název
                            <strong>MONO</strong>. Kompletní přepis vizuálu a filosofie.
                        </p>
                        <ul class="list-disc pl-5 text-slate-400 space-y-1">
                            <li data-i18n="updates.v1.upgrade.list.visual"><span class="text-emerald-400">Nový
                                    Vizuál:</span> Temný,
                                neuro-adaptivní design pro snížení zátěže.</li>
                            <li data-i18n="updates.v1.upgrade.list.youtube"><span class="text-blue-400">YouTube
                                    Integrace:</span>
                                Možnost vložit vlastní ID videa pro video pozadí.</li>
                            <li data-i18n="updates.v1.upgrade.list.detox"><span class="text-purple-400">Dopaminový
                                    Detox:</span>
                                Odstraněny gamifikační prvky,
                                důraz na "Monotasking" .</li>
                        </ul>
                    </div>
                    <div class="bg-slate-800/40 p-6 rounded-xl border border-slate-700/50">
                        <h3 class="font-bold text-lg text-white mb-3" data-i18n="updates.v1.modules.title">🧠 Nové
                            Funkční Moduly
                        </h3>
                        <ul class="space-y-3">
                            <li class="flex items-start gap-3"> <span class="text-xl">📊</span>
                                <div> <span class="text-slate-200 block font-medium"
                                        data-i18n="updates.v1.modules.list.timer.title">SVG
                                        Časovač & Controls</span> <span class="text-slate-400 text-sm"
                                        data-i18n="updates.v1.modules.list.timer.desc">Nový vizuální
                                        kruhový
                                        časovač s integrovaným ovládáním a Brown Noise
                                        generátorem.</span> </div>
                            </li>
                            <li class="flex items-start gap-3"> <span class="text-xl">🧘</span>
                                <div> <span class="text-slate-200 block font-medium"
                                        data-i18n="updates.v1.modules.list.regen.title">Neuro-Regenerační
                                        Přestávky</span> <span class="text-slate-400 text-sm"
                                        data-i18n="updates.v1.modules.list.regen.desc">Inteligentní návrhy
                                        aktivit (Box Breathing,
                                        Palming) během pauzy.</span> </div>
                            </li>
                            <li class="flex items-start gap-3"> <span class="text-xl">✅</span>
                                <div> <span class="text-slate-200 block font-medium"
                                        data-i18n="updates.v1.modules.list.parking.title">Parkoviště
                                        Myšlenek v2</span> <span class="text-slate-400 text-sm"
                                        data-i18n="updates.v1.modules.list.parking.desc">Možnost označovat
                                        myšlenky jako hotové a mazat je. Persistence
                                        dat.</span> </div>
                            </li>
                        </ul>
                    </div>
                    <div class="bg-slate-800/40 p-6 rounded-xl border border-slate-700/50">
                        <h3 class="font-bold text-lg text-white mb-3" data-i18n="updates.v1.blog.title">📰 Blog &
                            Znalosti
                        </h3>
                        <p class="text-slate-400" data-i18n="updates.v1.blog.text">Nová sekce s články o neuro-ergonomii
                            a
                            produktivitě.</p>
                    </div>
                </div>
            </div>
            <!-- v2.0 (History) -->
            <div class="relative opacity-60 hover:opacity-100 transition-opacity">
                <div class="absolute -left-[41px] top-1 w-5 h-5 rounded-full bg-slate-700 border-4 border-slate-900">
                </div>
                <h2 class="text-xl font-bold text-slate-400 mb-2" data-i18n="updates.history.v2.title">FocusFlow v2.0
                </h2>
                <div class="text-sm text-slate-600 mb-4 font-mono" data-i18n="updates.history.v2.date">Červen 2025</div>
                <p class="text-slate-500" data-i18n="updates.history.v2.text">Původní verze s důrazem na "Flow States" .
                    Zavedení Parkoviště myšlenek.</p>
            </div>
            <!-- v2.0 -->
            <div class="relative opacity-60 hover:opacity-100 transition-opacity">
                <div class="absolute -left-[41px] top-1 w-5 h-5 rounded-full bg-slate-700 border-4 border-slate-900">
                </div>
                <h2 class="text-xl font-bold text-slate-300 mb-2" data-i18n="updates.history.core.title">v2.0 - Core
                    Flow
                </h2>
                <div class="text-sm text-slate-600 mb-4 font-mono" data-i18n="updates.history.core.date">Listopad 2024
                </div>
                <ul class="list-disc pl-5 text-slate-500 space-y-1">
                    <li data-i18n="updates.history.core.list.l1">Základní Pomodoro logika (Prep, Work, Break).</li>
                    <li data-i18n="updates.history.core.list.l2">Audio Engine (Bílý šum).</li>
                    <li data-i18n="updates.history.core.list.l3">Lokální ukládání úkolů.</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Feedback Section -->
    <section id="feedbackSection"
        class="hidden fixed inset-0 w-full h-screen overflow-y-auto pt-32 pb-20 px-6 max-w-4xl mx-auto z-10 relative bg-slate-900/95 backdrop-blur-sm">
        <div class="mb-12 text-center">
            <h1 class="text-4xl font-bold text-white mb-4" data-i18n="feedback.title">Zpětná Vazba</h1>
            <p class="text-slate-400 max-w-xl mx-auto" data-i18n="feedback.subtitle">Máte nápad na zlepšení? Nebo se vám
                něco nelíbí? Dejte nám vědět. Všechny podněty jsou veřejné.</p>
        </div>

        <div class="flex justify-center w-full">
            <iframe
                src="https://docs.google.com/forms/d/e/1FAIpQLSe-74Lw0FTS_hmNFFNlYiGphNFH9tYVyKTQUEydP8IHklud0Q/viewform?embedded=true"
                width="100%" height="759" frameborder="0" marginheight="0" marginwidth="0"
                class="w-full max-w-2xl border border-slate-700/50 rounded-xl bg-slate-800/50">Načítání…</iframe>
        </div>
    </section>
    <!-- Overlay Background Elements -->
    <div class="fixed top-0 left-0 w-full h-full pointer-events-none z-0 overflow-hidden">
        <div class="absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-blue-500/10 rounded-full blur-[120px]">
        </div>
        <div class="absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-cyan-500/10 rounded-full blur-[120px]">
        </div>
    </div>
    <script> // --- APP STATE ---

        const state = {
            phase: 'PREP', // PREP, WORK, BREAK
            timeLeft: 21.25 * 60,
            totalDuration: 21.25 * 60,
            timerId: null,
            breakIntervalId: null,
            isPaused: false,
            currentTask: '',
            audioContext: null,
            noiseNode: null,
            isNoisePlaying: false,
            thoughts: JSON.parse(localStorage.getItem('mono_thoughts') || '[]'),
            sessionHistory: JSON.parse(sessionStorage.getItem('mono_history') || '[]'),
            feedback: JSON.parse(localStorage.getItem('mono_feedback') || '[]'),
            sessionStartTime: null,
            currentBreakActivity: null,
            isEvening: new Date().getHours() >= 18 || new Date().getHours() < 6
        }

            ;

        // --- STATE MANAGEMENT ---
        function setState(updates) {
            Object.assign(state, updates);

            // Side Effects & Reactivity
            if (updates.hasOwnProperty('phase') || updates.hasOwnProperty('isEvening')) {
                updateTheme();
            }

            if (updates.hasOwnProperty('thoughts')) {
                localStorage.setItem('mono_thoughts', JSON.stringify(state.thoughts));
                renderThoughts(); // Re-render if data changes
            }

            if (updates.hasOwnProperty('sessionHistory')) {
                sessionStorage.setItem('mono_history', JSON.stringify(state.sessionHistory));
                renderSessionLog();
            }
        }

        // Periodic Time Check (Every 60s)
        setInterval(() => {
            const hour = new Date().getHours();
            const isEvening = hour >= 18 || hour < 6;

            if (state.isEvening !== isEvening) {
                setState({
                    isEvening
                });
            }
        }

            , 60000);

        // --- I18N CONFIG ---
        const TRANSLATIONS = {
            cs: {
                title: "MONO - Hluboká Práce",
                nav: {
                    app: "Fokus",
                    blog: "Články",
                    docs: "Aktualizace",
                    feedback: "Zpětná Vazba",
                    lang: "EN"
                },
                prep: {
                    goalLabel: "The One Thing",
                    goalPlaceholder: "Na čem budete pracovat?",
                    timeLabel: "Časový Blok (min)",
                    startBtn: "Vstoupit do Zóny",
                    youtubeLabel: "Soundtrack (YouTube URL)"
                },
                work: {
                    stop: "Ukončit",
                    playing: "Soustředění...",
                    paused: "Pozastaveno",
                    noiseTitle: "Hnědý Šum"
                },
                break: {
                    title: "Neuro-Regenerace",
                    subtitle: "Doplňte dopamin pro další cyklus.",
                    startBtn: "Spustit cvičení",
                    skipBtn: "Přeskočit",
                    finishBtn: "Ukončit cvičení"
                },
                parking: {
                    title: "Parkoviště myšlenek",
                    subtitle: "Rušivá myšlenka? Odložte si ji sem a vraťte se k práci.",
                    placeholder: "Napište myšlenku...",
                    addBtn: "Uložit",
                    empty: "Žádné myšlenky zatím..."
                },
                sessionLog: {
                    title: "Historie Relace",
                    subtitle: "Přehled dokončených úkolů v této relaci (vymaže se po zavření prohlížeče).",
                    totalTime: "Celkový čas soustředění",
                    empty: "Zatím žádná aktivita v této relaci."
                },
                blog: {
                    readArticle: "Číst článek",
                    readTime: "čtení",
                    back: "Zpět na přehled"
                },
                hero: {
                    tagline: "Nástroj pro přechod od nestíhání k monotaskingu.",
                    subtagline: "Definujte svůj záměr."
                },
                help: {
                    menu: "Manuál",
                    sections: {
                        philosophy: {
                            title: "01. Filosofie Designu",
                            text1: "Většina \"to-do\" aplikací vás zahlcuje seznamy úkolů. MONO je jiný. Je to \"Attention Management System\" (Systém řízení pozornosti). Jeho cílem není, abyste toho \"stihli více\", ale abyste dělali to podstatné v hlubším soustředění.",
                            quote: "\"Skutečná produktivita není o rychlosti, ale o jasnosti mysli a zdravém rytmu.\"",
                            text2: "Aplikace respektuje vaše neurobiologické limity. Využívá Ultragdiánní rytmy (90 min aktivity) a automaticky vás nutí k odpočinku dříve, než se vyčerpají vaše zásoby dopaminu."
                        },
                        workflow: {
                            title: "02. Pracovní Cyklus",
                            prep: { title: "Fáze 1: Příprava (Prep)", text: "Mozek potřebuje jasný záměr. V této fázi definujete JEDEN úkol. Žádné seznamy. Zde si také nastavíte zvukovou kulisu (YouTube) a časovač (doporučeno 25-50 min)." },
                            flow: { title: "Fáze 2: Práce (Flow)", text: "Vše zmizí. Zůstává jen odpočet a váš úkol. Využijte Parkoviště myšlenek (vpravo nahoře) pro odložení rušivých nápadů, aniž byste opustili kontext." },
                            regen: { title: "Fáze 3: Regenerace (Regen)", text: "Po skončení časovače se aplikace přepne do Jantarového módu. Nyní nesmíte pracovat. Aplikace vám nabídne techniky jako NSDR, Box Breathing nebo Mikro-pohyb pro obnovu kognitivních zdrojů." }
                        },
                        features: {
                            title: "03. Klíčové Funkce",
                            focus: { title: "Hlavní Panel (Fokus)", text: "Centrální místo pro vaši práci. Zadejte JEDEN úkol (\"The One Thing\"), nastavte délku bloku (25/50/90 min) a zvolte soundtrack. Jednoduchost je záměrná – nic vás nesmí rozptylovat. Cirkadiánní logika automaticky upravuje barevné schéma podle denní doby (po 18:00 se aktivuje Jantarový mód)." },
                            blog: { title: "Neuro-Insights (Blog)", text: "Pochopte \"proč\". Sekce článků vysvětluje vědecké podklady našich technik (Hnědý šum, NSDR, Cirkadiánní rytmy). Přepínejte mezi Fokusem a Články pomocí nového navigačního menu nahoře." },
                            parking: { title: "Parkoviště Myšlenek", text: "Externí paměť pro vaše nápady. Když vás při práci něco napadne, neotvírejte novou záložku. Zapište to sem (ikona krabice vpravo nahoře) a okamžitě se vraťte k práci." },
                            log: { title: "Historie Relace", text: "Sledujte svůj postup. Zobrazuje dokončené bloky a celkový čas soustředění v dané seanci. Data se resetují při zavření prohlížeče (podporuje \"čistý štít\" každý den)." }
                        },
                        youtube: {
                            title: "04. YouTube Integrace",
                            text: "MONO přímo integruje YouTube přehrávač pro vaše focus playlisty. Video se automaticky:",
                            list1: "Spustí při startu časovače.",
                            list2: "Zastaví při pauze nebo konci bloku.",
                            channels: "Doporučené Kanály:",
                            channelsList: {
                                lofi: "<strong>Lofi Girl</strong> - pro studium a rutinní práci.",
                                endel: "<strong>Endel</strong> - vědecky navržené zvukové krajiny.",
                                brainfm: "<strong>Brain.fm</strong> - pro intenzivní kognitivní výkon."
                            },
                            error: "Důležité: YouTube Error 150/153",
                            errorText: "Některá videa nejdou přehrát mimo YouTube. Pokud se video nenačte, zkuste najít \"No Copyright\" verzi nebo jiný kanál. Ujistěte se, že aplikaci spouštíte přes server."
                        },
                        deploy: {
                            title: "05. Nasazení & Spouštění",
                            online: {
                                title: "Online (Doporučeno)",
                                text: "Pro bezproblémové fungování YouTube API doporučujeme aplikaci nahrát na statický hosting (Netlify, GitHub Pages). Není potřeba žádný backend.",
                                list: {
                                    netlify: "<strong>Netlify Drop:</strong> Pouze přetáhněte složku projektu do prohlížeče.",
                                    github: "<strong>GitHub Pages:</strong> Nasazení přímo z repozitáře (v Nastavení -> Pages)."
                                }
                            },
                            local: { title: "Lokální Vývoj", text: "Pokud spouštíte aplikaci lokálně, neotevírejte index.html dvojklikem. YouTube API vyžaduje protokol HTTP/HTTPS (např. python3 -m http.server)." },
                            data: { title: "Data a Soukromí", text: "Všechna data jsou ukládána pouze ve vašem prohlížeči (LocalStorage). Aplikace funguje 100% offline (kromě YouTube funkcionality)." }
                        },
                        techniques: {
                            title: "Přehled Implementovaných Technik"
                        }
                    },
                    title: "Průvodce MONO"
                },
                feedback: {
                    title: "Zpětná Vazba",
                    subtitle: "Máte nápad na zlepšení? Nebo se vám něco nelíbí? Dejte nám vědět. Všechny podněty jsou veřejné.",
                    formTitle: "Přidat Podnět",
                    labelName: "Jméno (Volitelné)",
                    labelMessage: "Zpráva",
                    submitBtn: "Odeslat",
                    listTitle: "Nedávné Podněty",
                    empty: "Zatím žádné podněty. Buďte první!"
                },
                updates: {
                    title: "Aktualizace",
                    subtitle: "Přehled novinek a změn v aplikaci MONO.",
                    v1_1: {
                        date: "31. Prosince 2025",
                        title: "✨ Feedback & Ladění",
                        desc: "Přidána možnost zpětné vazby a opravy v překladech.",
                        list: {
                            feedback: "<span class=\"text-pink-400\">Zpětná Vazba:</span> Nová sekce pro vaše nápady.",
                            fixes: "<span class=\"text-indigo-400\">Fixes:</span> Opraveno vykreslování HTML tagů v překladech."
                        }
                    },
                    v1: {
                        date: "23. Prosince 2025",
                        upgrade: {
                            title: "🚀 Rebranding & Upgrade",
                            text: "Aplikace nyní nese název <strong>MONO</strong>. Kompletní přepis vizuálu a filosofie.",
                            list: {
                                visual: "<span class=\"text-emerald-400\">Nový Vizuál:</span> Temný, neuro-adaptivní design pro snížení zátěže.",
                                youtube: "<span class=\"text-blue-400\">YouTube Integrace:</span> Možnost vložit vlastní ID videa pro video pozadí.",
                                detox: "<span class=\"text-purple-400\">Dopaminový Detox:</span> Odstraněny gamifikační prvky, důraz na \"Monotasking\"."
                            }
                        },
                        modules: {
                            title: "🧠 Nové Funkční Moduly",
                            list: {
                                timer: { title: "SVG Časovač & Controls", desc: "Nový vizuální kruhový časovač s integrovaným ovládáním a Brown Noise generátorem." },
                                regen: { title: "Neuro-Regenerační Přestávky", desc: "Inteligentní návrhy aktivit (Box Breathing, Palming) během pauzy." },
                                parking: { title: "Parkoviště Myšlenek v2", desc: "Možnost označovat myšlenky jako hotové a mazat je. Persistence dat." }
                            }
                        },
                        blog: {
                            title: "📰 Blog & Znalosti",
                            text: "Nová sekce s články o neuro-ergonomii a produktivitě."
                        }
                    },
                    history: {
                        v2: {
                            title: "FocusFlow v2.0",
                            date: "Červen 2025",
                            text: "Původní verze s důrazem na \"Flow States\". Zavedení Parkoviště myšlenek."
                        },
                        core: {
                            title: "v2.0 - Core Flow",
                            date: "Listopad 2024",
                            list: {
                                l1: "Základní Pomodoro logika (Prep, Work, Break).",
                                l2: "Audio Engine (Bílý šum).",
                                l3: "Lokální ukládání úkolů."
                            }
                        }
                    }
                },
                blog: {
                    readArticle: "Číst článek",
                    readTime: "čtení",
                    back: "Zpět na přehled",
                    subtitle: "Optimalizace kognitivního výkonu pomocí vědy, technologie a designu."
                }
            },
            en: {
                title: "MONO - Deep Work",
                nav: {
                    app: "Focus",
                    blog: "Articles",
                    docs: "Updates",
                    feedback: "Feedback",
                    lang: "CS"
                },
                prep: {
                    goalLabel: "The One Thing",
                    goalPlaceholder: "What will you work on?",
                    timeLabel: "Time Block (min)",
                    startBtn: "Enter the Zone",
                    youtubeLabel: "Soundtrack (YouTube URL)"
                },
                work: {
                    stop: "Finish Session",
                    playing: "Focusing...",
                    paused: "Paused",
                    noiseTitle: "Brown Noise"
                },
                break: {
                    title: "Neuro-Regeneration",
                    subtitle: "Replenish dopamine for the next cycle.",
                    startBtn: "Start Exercise",
                    skipBtn: "Skip",
                    finishBtn: "End Exercise"
                },
                parking: {
                    title: "Thought Parking Lot",
                    subtitle: "Distracting thought? Park it here and get back to work.",
                    placeholder: "Type a thought...",
                    addBtn: "Save",
                    empty: "No thoughts yet..."
                },
                sessionLog: {
                    title: "Session History",
                    subtitle: "Overview of completed tasks in this session (clears on browser close).",
                    totalTime: "Total Focus Time",
                    empty: "No activity in this session yet."
                },
                blog: {
                    readArticle: "Read Article",
                    readTime: "read",
                    back: "Back to Overview",
                    subtitle: "Optimizing cognitive performance through science, technology, and design."
                },
                hero: {
                    tagline: "Tool to transition from overwhelmed to monotasking.",
                    subtagline: "Define your intention."
                },
                help: {
                    menu: "Manual",
                    title: "MONO Guide",
                    sections: {
                        philosophy: {
                            title: "01. Design Philosophy",
                            text1: "Most \"to-do\" apps overwhelm you with task lists. MONO is different. It is an \"Attention Management System\". Its goal is not for you to \"get more done\", but to do what is essential with deeper focus.",
                            quote: "\"True productivity is not about speed, but about clarity of mind and healthy rhythm.\"",
                            text2: "The app respects your neurobiological limits. It uses Ultradian rhythms (90 min activity) and automatically forces you to rest before your dopamine reserves are depleted."
                        },
                        workflow: {
                            title: "02. Workflow",
                            prep: { title: "Phase 1: Preparation (Prep)", text: "The brain needs a clear intention. In this phase, you define ONE task. No lists. Here you also set the soundscape (YouTube) and timer (recommended 25-50 min)." },
                            flow: { title: "Phase 2: Work (Flow)", text: "Everything disappears. Only the countdown and your task remain. Use the Thought Parking Lot (top right) to park distracting ideas without leaving the context." },
                            regen: { title: "Phase 3: Regeneration (Regen)", text: "When the timer ends, the app switches to Amber mode. You must not work now. The app offers techniques like NSDR, Box Breathing, or Micro-movements to restore cognitive resources." }
                        },
                        features: {
                            title: "03. Key Features",
                            focus: { title: "Main Panel (Focus)", text: "The central place for your work. Enter ONE task (\"The One Thing\"), set the block length (25/50/90 min) and choose a soundtrack. Simplicity is intentional – nothing should distract you. Circadian logic automatically adjusts the color scheme based on the time of day (Amber mode activates after 18:00)." },
                            blog: { title: "Neuro-Insights (Blog)", text: "Understand the \"why\". The articles section explains the scientific basis of our techniques (Brown noise, NSDR, Circadian rhythms). Switch between Focus and Articles using the new navigation menu at the top." },
                            parking: { title: "Idea Parking", text: "External memory for your ideas. When something occurs to you while working, don't open a new tab. Write it here (box icon top right) and immediately return to work." },
                            log: { title: "Session History", text: "Track your progress. Displays completed blocks and total focus time in the current session. Data resets when the browser closes (supports a \"clean slate\" every day)." }
                        },
                        youtube: {
                            title: "04. YouTube Integration",
                            text: "MONO directly integrates a YouTube player for your focus playlists. The video automatically:",
                            list1: "Starts when the timer starts.",
                            list2: "Stops on pause or block end.",
                            channels: "Recommended Channels:",
                            channelsList: {
                                lofi: "<strong>Lofi Girl</strong> - for study and routine work.",
                                endel: "<strong>Endel</strong> - scientifically designed soundscapes.",
                                brainfm: "<strong>Brain.fm</strong> - for intense cognitive performance."
                            },
                            error: "Important: YouTube Error 150/153",
                            errorText: "Some videos cannot be played outside YouTube. If a video doesn't load, try a \"No Copyright\" version or another channel. Ensure you are running the app via a server."
                        },
                        deploy: {
                            title: "05. Deployment & Running",
                            online: {
                                title: "Online (Recommended)",
                                text: "For seamless YouTube API functionality, we recommend uploading the app to static hosting (Netlify, GitHub Pages). No backend required.",
                                list: {
                                    netlify: "<strong>Netlify Drop:</strong> Just drag and drop the project folder into the browser.",
                                    github: "<strong>GitHub Pages:</strong> Deploy directly from the repository (in Settings -> Pages)."
                                }
                            },
                            local: { title: "Local Development", text: "If running locally, do not open index.html by double-clicking. The YouTube API requires HTTP/HTTPS capability (e.g., python3 -m http.server)." },
                            data: { title: "Data & Privacy", text: "All data is stored only in your browser (LocalStorage). The app works 100% offline (except for YouTube functionality)." }
                        },
                        techniques: {
                            title: "Overview of Implemented Techniques"
                        }
                    }
                },
                feedback: {
                    title: "Feedback",
                    subtitle: "Have an idea for improvement? Or dislike something? Let us know. All feedback is public.",
                    formTitle: "Add Suggestion",
                    labelName: "Name (Optional)",
                    labelMessage: "Message",
                    submitBtn: "Submit",
                    listTitle: "Recent Suggestions",
                    empty: "No suggestions yet. Be the first!"
                },
                updates: {
                    title: "Updates",
                    subtitle: "Overview of news and changes in MONO.",
                    v1_1: {
                        date: "December 31, 2025",
                        title: "✨ Feedback & Polish",
                        desc: "Added feedback capability and fixed translation issues.",
                        list: {
                            feedback: "<span class=\"text-pink-400\">Feedback:</span> New section for your ideas.",
                            fixes: "<span class=\"text-indigo-400\">Fixes:</span> Fixed HTML tag rendering in translations."
                        }
                    },
                    v1: {
                        date: "December 23, 2025",
                        upgrade: {
                            title: "🚀 Rebranding & Upgrade",
                            text: "The application is now called <strong>MONO</strong>. Complete visual and philosophical rewrite.",
                            list: {
                                visual: "<span class=\"text-emerald-400\">New Visuals:</span> Dark, neuro-adaptive design to reduce load.",
                                youtube: "<span class=\"text-blue-400\">YouTube Integration:</span> Ability to insert custom video ID for video background.",
                                detox: "<span class=\"text-purple-400\">Dopamine Detox:</span> Removed gamification elements, emphasis on \"Monotasking\"."
                            }
                        },
                        modules: {
                            title: "🧠 New Functional Modules",
                            list: {
                                timer: { title: "SVG Timer & Controls", desc: "New visual circular timer with integrated controls and Brown Noise generator." },
                                regen: { title: "Neuro-Regenerative Breaks", desc: "Intelligent activity suggestions (Box Breathing, Palming) during breaks." },
                                parking: { title: "Thought Parking v2", desc: "Ability to mark thoughts as done and delete them. Data persistence." }
                            }
                        },
                        blog: {
                            title: "📰 Blog & Knowledge",
                            text: "New section with articles on neuro-ergonomics and productivity."
                        }
                    },
                    history: {
                        v2: {
                            title: "FocusFlow v2.0",
                            date: "June 2025",
                            text: "Original version with emphasis on \"Flow States\". Introduction of Thought Parking."
                        },
                        core: {
                            title: "v2.0 - Core Flow",
                            date: "November 2024",
                            list: {
                                l1: "Basic Pomodoro logic (Prep, Work, Break).",
                                l2: "Audio Engine (White noise).",
                                l3: "Local task storage."
                            }
                        }
                    }
                }
            }
        };

        let currentLang = localStorage.getItem('mono_lang') || 'cs';

        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('mono_lang', lang);
            updateDOMTranslations();
            renderBlogList(); // Re-render blog to translate dynamic content

            // Update Toggle Button Text
            const langBtn = document.getElementById('langToggle');
            if (langBtn) langBtn.innerText = lang === 'cs' ? 'EN' : 'CZ';

            document.title = TRANSLATIONS[lang].title || 'MONO';
        }

        function t(path) {
            return path.split('.').reduce((obj, key) => obj && obj[key], TRANSLATIONS[currentLang]) || path;
        }

        function updateDOMTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                const translation = t(key);

                if (el.tagName === 'INPUT' && el.getAttribute('placeholder')) {
                    el.placeholder = translation;
                } else {
                    el.innerHTML = translation;
                }
            });
        }
        const REST_ACTIVITIES = [{
            title: { cs: 'Box Breathing', en: 'Box Breathing' },
            desc: {
                cs: 'Nádech (4s) - Zadržet (4s) - Výdech (4s) - Zadržet (4s). Opakujte pro zklidnění nervové soustavy.',
                en: 'Inhale (4s) - Hold (4s) - Exhale (4s) - Hold (4s). Repeat to calm your nervous system.'
            },
            duration: 5 * 60, // 5 min
            type: 'breathing'
        },
        {
            title: { cs: 'Fyziologický Vzdech', en: 'Physiological Sigh' },
            desc: {
                cs: 'Dva krátké nádechy nosem pro plné roztažení plic, následované dlouhým výdechem ústy.',
                en: 'Two short inhales through the nose to fully expand lungs, followed by a long exhale through the mouth.'
            },
            duration: 5 * 60, // 5 min
            type: 'timer'
        },
        {
            title: { cs: 'Vizuální Panorama', en: 'Visual Panorama' },
            desc: {
                cs: 'Jděte k oknu. Rozostřete pohled a vnímejte periferní vidění. Uvolňuje to "zaostřovací" stres.',
                en: 'Go to a window. Soften your gaze and engage peripheral vision. Relieves "focus" stress.'
            },
            duration: 5 * 60, // 5 min
            type: 'timer'
        },
        {
            title: { cs: 'Mikro-Pohyb', en: 'Micro-Movement' },
            desc: {
                cs: '5 minut lehkého pohybu. Dřepy, protahování v rámu dveří nebo chůze po místnosti.',
                en: '5 minutes of light movement. Squats, doorway stretches, or walking around the room.'
            },
            duration: 5 * 60, // 5 min
            type: 'timer'
        },
        {
            title: { cs: 'Hydratace + Tma', en: 'Hydration + Darkness' },
            desc: {
                cs: 'Napijte se vody. Poté si zakryjte oči dlaněmi (palming) pro úplnou tmu a regeneraci sítnice.',
                en: 'Drink water. Then cup your palms over your eyes (palming) for total darkness and retinal regeneration.'
            },
            duration: 5 * 60, // 5 min
            type: 'timer'
        }];

        // --- DOM ELEMENTS ---
        const els = {
            app: document.getElementById('app'),
            prepPhase: document.getElementById('prepPhase'),
            workPhase: document.getElementById('workPhase'),
            breakPhase: document.getElementById('breakPhase'),

            // Inputs
            taskInput: document.getElementById('taskInput'),
            timeInput: document.getElementById('timeInput'),

            // Displays
            timerDisplay: document.getElementById('timerDisplay'),
            timerProgress: document.getElementById('timerProgress'),
            currentTaskDisplay: document.getElementById('currentTaskDisplay'),

            // Break Elements
            regenInstructionView: document.getElementById('regenInstructionView'),
            regenActiveView: document.getElementById('regenActiveView'),
            breakActivityTitle: document.getElementById('breakActivityTitle'),
            breakActivityDesc: document.getElementById('breakActivityDesc'),
            breakActivityDuration: document.getElementById('breakActivityDuration'),
            activeBreakTitle: document.getElementById('activeBreakTitle'),
            breakTimerDisplay: document.getElementById('breakTimerDisplay'),
            visualizerCircle: document.getElementById('visualizerCircle'),

            // Buttons
            startBtn: document.getElementById('startBtn'),
            stopBtn: document.getElementById('stopBtn'),
            noiseBtn: document.getElementById('noiseBtn'),
            toggleTimerBtn: document.getElementById('toggleTimerBtn'),
            startBreakBtn: document.getElementById('startBreakBtn'),
            skipBreakBtn: document.getElementById('skipBreakBtn'),
            finishBreakBtn: document.getElementById('finishBreakBtn'),

            // Icons
            playIcon: document.getElementById('playIcon'),
            pauseIcon: document.getElementById('pauseIcon'),
            noiseIconOn: document.getElementById('noiseIconOn'),
            noiseIconOff: document.getElementById('noiseIconOff'),

            // Toggles
            parkingLotToggle: document.getElementById('parkingLotToggle'),
            parkingLotOverlay: document.getElementById('parkingLotOverlay'),
            closeParkingLot: document.getElementById('closeParkingLot'),
            thoughtInput: document.getElementById('thoughtInput'),
            addThoughtBtn: document.getElementById('addThoughtBtn'),
            thoughtsList: document.getElementById('thoughtsList'),

            // Session Log
            sessionLogToggle: document.getElementById('sessionLogToggle'),
            sessionLogOverlay: document.getElementById('sessionLogOverlay'),
            closeSessionLog: document.getElementById('closeSessionLog'),
            sessionLogList: document.getElementById('sessionLogList'),
            totalFocusTime: document.getElementById('totalFocusTime'),

            // Help
            helpToggle: document.getElementById('helpToggle'),
            helpOverlay: document.getElementById('helpOverlay'),
            closeHelp: document.getElementById('closeHelp'),
            techniquesList: document.getElementById('techniquesList')
        }

            ;

        // --- AUDIO ENGINE ---
        function initAudio() {
            if (!state.audioContext) {
                state.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function toggleNoise() {
            initAudio();

            if (state.isNoisePlaying) {
                if (state.noiseNode) {
                    try {
                        state.noiseNode.stop();
                    }

                    catch (e) {
                        console.log(e);
                    }
                }

                setState({
                    isNoisePlaying: false
                });
                els.noiseIconOn.classList.add('hidden');
                els.noiseIconOff.classList.remove('hidden');
                els.noiseBtn.classList.remove('border-neuro-focus', 'text-neuro-focus', 'bg-slate-800');
                els.noiseBtn.classList.add('border-slate-700', 'text-slate-400', 'bg-slate-800/80');
            }

            else {
                const bufferSize = state.audioContext.sampleRate * 2;
                const buffer = state.audioContext.createBuffer(1, bufferSize, state.audioContext.sampleRate);
                const data = buffer.getChannelData(0);

                for (let i = 0; i < bufferSize; i++) {
                    const white = Math.random() * 2 - 1;
                    data[i] = (i === 0 ? 0 : 0.1 * data[i - 1]) + white * 0.05;
                    data[i] *= 3.5;
                }

                state.noiseNode = state.audioContext.createBufferSource();
                state.noiseNode.buffer = buffer;
                state.noiseNode.loop = true;

                const gainNode = state.audioContext.createGain();
                gainNode.gain.value = 0.5;
                state.noiseNode.connect(gainNode);
                gainNode.connect(state.audioContext.destination);

                state.noiseNode.start();

                setState({
                    isNoisePlaying: true
                });

                els.noiseIconOn.classList.remove('hidden');
                els.noiseIconOff.classList.add('hidden');
                els.noiseBtn.classList.add('border-neuro-focus', 'text-neuro-focus', 'bg-slate-800');
                els.noiseBtn.classList.remove('border-slate-700', 'text-slate-400', 'bg-slate-800/80');
            }
        }

        function playGong() {
            initAudio();
            const osc = state.audioContext.createOscillator();
            const gain = state.audioContext.createGain();

            osc.frequency.setValueAtTime(200, state.audioContext.currentTime);
            osc.frequency.exponentialRampToValueAtTime(0.01, state.audioContext.currentTime + 2);

            gain.gain.setValueAtTime(0.5, state.audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, state.audioContext.currentTime + 2);

            osc.connect(gain);
            gain.connect(state.audioContext.destination);

            osc.start();
            osc.stop(state.audioContext.currentTime + 2);
        }

        // --- VISUALIZATION LOGIC ---
        function updateTimerVisuals() {
            els.timerDisplay.textContent = formatTime(state.timeLeft);

            // Full circle is offset 0. Empty is 283.
            const fraction = state.timeLeft / state.totalDuration;
            const offset = 283 * (1 - fraction);
            els.timerProgress.style.strokeDashoffset = offset;
        }

        // --- CORE LOGIC ---

        function formatTime(seconds) {
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');

            return `${m}:${s}`;
        }

        // --- FEEDBACK LOGIC ---
        function addFeedback(e) {
            e.preventDefault();
            const nameInput = document.getElementById('fbName');
            const msgInput = document.getElementById('fbMessage');

            if (!msgInput.value.trim()) return;

            const newFeedback = {
                id: Date.now(),
                name: nameInput.value.trim() || 'Anonym',
                text: msgInput.value.trim(),
                date: new Date().toISOString(),
                likes: 0
            };

            const updatedFeedback = [newFeedback, ...state.feedback];

            setState({ feedback: updatedFeedback });
            localStorage.setItem('mono_feedback', JSON.stringify(updatedFeedback));

            renderFeedback();
            e.target.reset();
        }

        function renderFeedback() {
            const list = document.getElementById('feedbackList');
            const count = document.getElementById('feedbackCount');

            if (!list) return;

            count.innerText = state.feedback.length;

            if (state.feedback.length === 0) {
                list.innerHTML = `<div class="text-center text-slate-500 py-12">${t('feedback.empty')}</div>`;
                return;
            }

            list.innerHTML = state.feedback.map(item => `
                <div class="bg-slate-800/30 p-5 rounded-xl border border-slate-700/50 hover:border-slate-600 transition-colors animate-fade-in">
                    <div class="flex justify-between items-start mb-2">
                        <span class="font-bold text-neuro-focus">${item.name}</span>
                        <span class="text-xs text-slate-500 font-mono">${new Date(item.date).toLocaleDateString()}</span>
                    </div>
                    <p class="text-slate-300 leading-relaxed">${item.text}</p>
                </div>
            `).join('');
        }

        function updateTheme() {
            // Derived from state now
            const isRegenMode = state.phase === 'BREAK' || state.isEvening;

            document.body.classList.remove('bg-neuro-focus-bg', 'bg-neuro-rest-bg', 'bg-slate-900', 'bg-black');

            if (isRegenMode) {
                document.body.classList.add('bg-neuro-rest-bg');
                document.body.dataset.theme = 'regen';
            }

            else {
                document.body.classList.add('bg-neuro-focus-bg');
                document.body.dataset.theme = 'focus';
            }
        }

        function switchPhase(newPhase) {
            els.prepPhase.classList.add('hidden');
            els.workPhase.classList.add('hidden');
            els.breakPhase.classList.add('hidden');

            // setPhase triggers updateTheme automatically via setState
            setState({
                phase: newPhase
            });

            if (newPhase === 'PREP') {
                els.prepPhase.classList.remove('hidden');
                // renderSessionLog handled by state change if history changed, but here it's UI switching
                renderSessionLog();
                document.title = 'MONO v1.0';
            }

            else if (newPhase === 'WORK') {
                els.workPhase.classList.remove('hidden');
                playGong();
            }

            else if (newPhase === 'BREAK') {
                els.breakPhase.classList.remove('hidden');
                setupBreak();
                document.title = t('break.title');
            }
        }

        function toggleTimer() {
            if (state.isPaused) {

                // Resume
                setState({
                    isPaused: false,
                    timerId: setInterval(tick, 1000)
                });
                els.playIcon.classList.add('hidden');

                if (player && player.playVideo && typeof player.playVideo === 'function') {
                    player.playVideo();
                }

                els.playIcon.classList.add('hidden');
                els.pauseIcon.classList.remove('hidden');
            }

            else {
                // Pause
                clearInterval(state.timerId);

                setState({
                    isPaused: true
                });
                els.playIcon.classList.remove('hidden');
                els.pauseIcon.classList.add('hidden');

                if (player && player.pauseVideo && typeof player.pauseVideo === 'function') {
                    player.pauseVideo();
                }

                if (state.isNoisePlaying) toggleNoise();
            }
        }

        function tick() {
            const nextTime = state.timeLeft - 1;

            setState({
                timeLeft: nextTime
            });

            updateTimerVisuals(); // Visual update can stay direct for performance or be in setState

            document.title = `${formatTime(state.timeLeft)} - MONO`;

            if (state.timeLeft <= 0) {
                completeSession();
            }
        }

        // --- YOUTUBE LOGIC (IFrame API) ---
        var player; // Global player instance
        var isYouTubeApiReady = false;

        function getYoutubeId(url) {
            if (!url) return null;
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        // Load YouTube API
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            isYouTubeApiReady = true;

            // Initialize player but keep it hidden/inactive until session start
            // We target a specific inner element to avoid replacing the main container if it has styling
            player = new YT.Player('ytPlayerFrame', {

                height: '100%',
                width: '100%',
                videoId: '',
                playerVars: {
                    'playsinline': 1,
                    'controls': 0, // No controls, controlled by app
                    'disablekb': 1,
                    'fs': 0,
                    'rel': 0
                }

                ,
                events: {
                    'onReady': onPlayerReady,
                    'onError': onPlayerError,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            console.log("YouTube Player Ready");
        }

        function onPlayerStateChange(event) {

            // Can handle buffering or finish here
            if (event.data === YT.PlayerState.ENDED) {
                player.playVideo(); // Loop
            }
        }

        function onPlayerError(event) {
            let errorMsg = "Video nelze přehrát.";

            if (event.data === 150 || event.data === 101) {
                errorMsg = "Vlastník videa zakázal přehrávání mimo YouTube (Error 150/101). Zkuste jiné video nebo 'No Copyright' kanály.";
            }

            else if (event.data === 2) {
                errorMsg = "Neplatné ID videa.";
            }

            else if (event.data === 5) {
                errorMsg = "HTML5 Error.";
            }

            else if (event.data === 100) {
                errorMsg = "Video nebylo nalezeno nebo je soukromé.";
            }

            alert(`YouTube Error: ${errorMsg}\n\nTip: Spouštějte přes lokální server pro lepší kompatibilitu.`);
        }


        const ytUrlInput = document.getElementById('ytUrlInput');
        const ytPreview = document.getElementById('ytPreview');
        const ytWorkPlayer = document.getElementById('ytWorkPlayer'); // The container

        if (ytUrlInput) {
            ytUrlInput.addEventListener('input', (e) => {
                const videoId = getYoutubeId(e.target.value);

                if (videoId) {
                    // Preview can stay simple iframe for now, or use API. Simple is robust enough for just "seeing" it.
                    // Using nocookie domain for preview
                    ytPreview.innerHTML = `<iframe width="100%" height="100%" src="https://www.youtube-nocookie.com/embed/${videoId}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>`;
                    ytPreview.classList.remove('hidden');
                }

                else {
                    ytPreview.innerHTML = '';
                    ytPreview.classList.add('hidden');
                }
            });
        }

        function startSession() {
            const task = els.taskInput.value.trim();

            if (!task) {
                els.taskInput.classList.add('animate-pulse', 'border-red-500');
                setTimeout(() => els.taskInput.classList.remove('animate-pulse', 'border-red-500'), 1000);
                return;
            }

            // Start YouTube
            // Start YouTube via API
            if (ytWorkPlayer && ytUrlInput) {
                const videoId = getYoutubeId(ytUrlInput.value);

                if (videoId && player && player.loadVideoById) {
                    ytWorkPlayer.classList.remove('hidden'); // Show container
                    player.loadVideoById(videoId);
                    // player.playVideo(); // loadVideoById usually autoplaS
                }
            }

            switchPhase('WORK');

            const duration = parseFloat(els.timeInput.value) || 21.25;

            setState({
                currentTask: task,
                workDurationConfig: duration, // store config
                timeLeft: duration * 60,
                totalDuration: duration * 60, // Fix: Update totalDuration for correct visual fraction
                sessionStartTime: new Date(),
                isPaused: false
            });

            els.currentTaskDisplay.textContent = state.currentTask;
            updateTimerVisuals();

            els.playIcon.classList.add('hidden');
            els.pauseIcon.classList.remove('hidden');

            switchPhase('WORK');


            if (state.timerId) clearInterval(state.timerId);

            setState({
                timerId: setInterval(tick, 1000)
            });
        }

        function stopSession() {
            clearInterval(state.timerId);

            setState({
                isPaused: false
            });

            if (state.isNoisePlaying) toggleNoise();

            // Stop YouTube
            // Stop YouTube
            if (player && player.stopVideo && typeof player.stopVideo === 'function') {
                player.stopVideo();
            }

            if (ytWorkPlayer) {
                ytWorkPlayer.classList.add('hidden');
            }

            switchPhase('PREP');
        }

        function completeSession() {
            clearInterval(state.timerId);

            setState({
                isPaused: false
            });

            if (state.isNoisePlaying) toggleNoise();

            // Stop YouTube on completion
            if (player && player.stopVideo && typeof player.stopVideo === 'function') {
                player.stopVideo();
            }

            playGong();

            const duration = parseFloat(els.timeInput.value) || 21.25;

            const newEntry = {
                task: state.currentTask,
                duration: duration,
                timestamp: new Date().toISOString()
            }

                ;

            // setState handles Storage update
            setState({
                sessionHistory: [newEntry, ...state.sessionHistory]
            });
            // sessionStorage.setItem('mono_history', JSON.stringify(state.sessionHistory)); -> Moved to setState side-effect

            switchPhase('BREAK');
        }

        // --- BREAK LOGIC ---
        function setupBreak() {
            els.regenInstructionView.classList.remove('hidden');
            els.regenActiveView.classList.add('hidden');
            if (state.breakIntervalId) clearInterval(state.breakIntervalId);
            els.visualizerCircle.classList.remove('animate-box-breathe');

            // Pick random activity
            const activity = REST_ACTIVITIES[Math.floor(Math.random() * REST_ACTIVITIES.length)];

            setState({
                currentBreakActivity: activity
            });

            els.breakActivityTitle.textContent = activity.title[currentLang];
            els.breakActivityDesc.textContent = activity.desc[currentLang];
            els.breakActivityDuration.textContent = formatTime(activity.duration);
        }

        function startBreakActivity() {
            els.regenInstructionView.classList.add('hidden');
            els.regenActiveView.classList.remove('hidden');

            const activity = state.currentBreakActivity;
            els.activeBreakTitle.textContent = activity.title[currentLang];

            setState({
                timeLeft: activity.duration
            });
            els.breakTimerDisplay.textContent = formatTime(state.timeLeft);

            if (activity.type === 'breathing') {
                els.visualizerCircle.classList.add('animate-box-breathe');
            }

            else {
                els.visualizerCircle.classList.remove('animate-box-breathe');
            }

            if (state.breakIntervalId) clearInterval(state.breakIntervalId);

            const interval = setInterval(() => {
                setState({
                    timeLeft: state.timeLeft - 1
                });
                els.breakTimerDisplay.textContent = formatTime(state.timeLeft);

                if (state.timeLeft <= 0) {
                    endBreakActivity();
                }
            }

                , 1000);
        }

        function endBreakActivity() {
            if (state.breakIntervalId) clearInterval(state.breakIntervalId);
            els.visualizerCircle.classList.remove('animate-box-breathe');
            switchPhase('PREP');
        }

        // --- PARKING LOT LOGIC ---
        // Migration handled in state initialization or here if needed
        function getSafeThoughts() {
            let loaded = JSON.parse(localStorage.getItem('mono_thoughts') || '[]');

            // Migration: Convert strings to objects if needed
            return loaded.map(item => {
                if (typeof item === 'string') {
                    return {
                        text: item, done: false
                    }

                        ;
                }

                return item;
            });
        }

        // Initialize state.thoughts via setState if needed, but it's done in initial state definition.

        function renderThoughts() {
            if (state.thoughts.length === 0) {
                els.thoughtsList.innerHTML = `<li class="text-center text-neuro-admin/50 italic py-4">${t('parking.empty')}</li>`;
                return;
            }

            els.thoughtsList.innerHTML = state.thoughts.map((t, i) => `
            <li class="group flex items-center justify-between p-3 rounded-lg border transition-all duration-200 ${t.done ? 'bg-neuro-admin/5 border-neuro-admin/10' : 'bg-slate-800/50 border-slate-700 hover:border-neuro-focus/30'}">
                <div class="flex items-center gap-3 overflow-hidden">
                    <button onclick="toggleThoughtStatus(${i})" class="flex-shrink-0 w-5 h-5 rounded border flex items-center justify-center transition-colors ${t.done ? 'bg-green-500/20 border-green-500 text-green-500' : 'border-slate-500 text-transparent hover:border-neuro-focus'}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="${t.done ? '' : 'hidden'}"><polyline points="20 6 9 17 4 12"></polyline></svg>
                    </button>
                    <span class="truncate text-sm transition-all ${t.done ? 'text-neuro-admin line-through decoration-slate-600' : 'text-slate-200'}">${t.text}</span>
                </div>
                <button onclick="deleteThought(${i})" class="p-2 rounded-md text-slate-600 hover:text-red-400 hover:bg-red-500/10 opacity-0 group-hover:opacity-100 transition-all" title="Smazat">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </li>
        `).join('');
            // localStorage update via setState side-effect
        }

        function addThought() {
            const val = els.thoughtInput.value.trim();

            if (val) {

                const newThoughts = [...state.thoughts,
                {
                    text: val, done: false
                }

                ];

                setState({
                    thoughts: newThoughts
                });
                els.thoughtInput.value = '';
                // renderThoughts(); -> Handled by setState
            }
        }

        window.toggleThoughtStatus = (index) => {
            const newThoughts = [...state.thoughts];
            newThoughts[index].done = !newThoughts[index].done;

            setState({
                thoughts: newThoughts
            });
        }

            ;

        window.deleteThought = (index) => {
            const newThoughts = [...state.thoughts];
            newThoughts.splice(index, 1);

            setState({
                thoughts: newThoughts
            });
        }

            ;

        // --- SESSION LOG LOGIC ---
        function renderSessionLog() {
            const totalMinutes = state.sessionHistory.reduce((acc, sess) => acc + sess.duration, 0);
            const hours = Math.floor(totalMinutes / 60);
            const mins = totalMinutes % 60;

            els.totalFocusTime.textContent = `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;

            if (state.sessionHistory.length === 0) {
                els.sessionLogList.innerHTML = `<li class="text-center text-slate-500 py-4 italic">${t('sessionLog.empty')}</li>`;
                return;
            }

            els.sessionLogList.innerHTML = state.sessionHistory.map(sess => {
                const date = new Date(sess.timestamp);

                const timeStr = date.toLocaleTimeString([], {
                    hour: '2-digit', minute: '2-digit'
                });

                return ` <li class="bg-slate-900/50 p-4 rounded-xl border border-slate-700 flex justify-between items-center group hover:border-slate-500 transition-all" > <div> <div class="font-medium text-white truncate max-w-[200px]" >${sess.task}</div> <div class="text-xs text-slate-500" >${timeStr}</div> </div> <div class="text-cyan-400 font-mono font-bold" >${sess.duration} min</div> </li> `;
            }).join('');
        }

        // --- HELP LOGIC ---
        function renderHelpTechniques() {
            const list = document.getElementById('techniquesList');

            if (list) {
                list.innerHTML = REST_ACTIVITIES.map(tech => ` <div class="bg-slate-900/50 p-4 rounded-xl border border-slate-700 hover:border-emerald-500/30 transition-colors" > <div class="flex justify-between items-start mb-2" > <h4 class="font-bold text-white" >${tech.title[currentLang]}</h4> <span class="text-xs font-mono text-emerald-400 px-2 py-1 bg-emerald-500/10 rounded-md" >${formatTime(tech.duration)}</span> </div> <p class="text-sm text-slate-400 leading-snug" >${tech.desc[currentLang]}</p> </div> `).join('');
            }
        }

        // --- EVENT LISTENERS ---
        els.startBtn.addEventListener('click', startSession);
        els.startBreakBtn.addEventListener('click', startBreakActivity);
        els.skipBreakBtn.addEventListener('click', () => switchPhase('PREP'));
        els.finishBreakBtn.addEventListener('click', endBreakActivity);

        // Parking Lot
        els.parkingLotToggle.addEventListener('click', () => {
            els.parkingLotOverlay.classList.toggle('open');
        });

        els.closeParkingLot.addEventListener('click', () => {
            els.parkingLotOverlay.classList.remove('open');
        });
        els.addThoughtBtn.addEventListener('click', addThought);

        els.thoughtInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addThought();
        });

        // Time Presets
        document.querySelectorAll('.time-preset').forEach(btn => {
            btn.addEventListener('click', (e) => {
                els.timeInput.value = e.target.dataset.time;
            });
        });

        // Session Log
        els.sessionLogToggle.addEventListener('click', () => {
            els.sessionLogOverlay.classList.remove('-translate-x-full');
            renderSessionLog();
        });

        els.closeSessionLog.addEventListener('click', () => {
            els.sessionLogOverlay.classList.add('-translate-x-full');
        });

        // Help Overlay
        els.helpToggle.addEventListener('click', () => {
            els.helpOverlay.classList.remove('hidden');
            renderHelpTechniques();
        });

        els.closeHelp.addEventListener('click', () => {
            els.helpOverlay.classList.add('hidden');
        });

        // --- BLOG LOGIC ---
        const ARTICLES = [{
            id: 1,
            title: { cs: 'Věda o Hnědém Šumu', en: 'The Science of Brown Noise' },
            excerpt: {
                cs: 'Proč brown noise funguje lépe než white noise pro hlubokou práci a ADHD?',
                en: 'Why brown noise works better than white noise for deep work and ADHD?'
            },
            image: 'assets/brown_noise_abstract_1766494072670.png',
            content: {
                cs: ` <h2 class="text-3xl text-white font-bold mb-4" >Hnědý šum vs. Bílý šum</h2> <p class="text-slate-300 mb-6" >Zatímco bílý šum zní jako syčení rádia (všechny frekvence stejně hlasitě), hnědý šum (Brown noise) tlumí vysoké frekvence. Zní spíše jako hluboké dunění vodopádu nebo vzdálené bouřky.</p> <h3 class="text-2xl text-neuro-focus mb-3" >Proč to funguje?</h3> <p class="text-slate-300 mb-6" >Mozek je neustále bombardován smyslovými vjemy. Hnědý šum poskytuje "zvukovou přikrývku"(stochastic resonance), která zvyšuje práh pro vyrušení externími zvuky. Podle studií může u lidí s nižší hladinou dopaminu (např. ADHD) tento šum stimulovat mozek k optimálnímu soustředění.</p> `,
                en: ` <h2 class="text-3xl text-white font-bold mb-4" >Brown Noise vs. White Noise</h2> <p class="text-slate-300 mb-6" >While white noise sounds like radio static (all frequencies at equal intensity), brown noise dampens high frequencies. It sounds more like the deep rumble of a waterfall or distant thunder.</p> <h3 class="text-2xl text-neuro-focus mb-3" >Why does it work?</h3> <p class="text-slate-300 mb-6" >The brain is constantly bombarded with sensory inputs. Brown noise provides a "sonic blanket" (stochastic resonance) that raises the threshold for external distractions. Studies suggest that for people with lower dopamine levels (e.g., ADHD), this noise can stimulate the brain for optimal focus.</p> `
            },
            date: { cs: '15. Února 2025', en: 'February 15, 2025' },
            readTime: { cs: '3 min', en: '3 min' }
        },
        {
            id: 2,
            title: { cs: 'Cirkadiánní Rytmy a Světlo', en: 'Circadian Rhythms & Light' },
            excerpt: {
                cs: 'Jak optimalizovat světelné podmínky pro maximální energii přes den a regeneraci v noci.',
                en: 'How to optimize lighting conditions for maximum energy during the day and regeneration at night.'
            },
            image: 'assets/circadian_rhythm_abstract_1766494095504.png',
            content: {
                cs: ` <h2 class="text-3xl text-white font-bold mb-4" >Světlo jako Zeitgeber</h2> <p class="text-slate-300 mb-6" >Světlo je hlavním synchronizátorem našich vnitřních hodin. Ranní expozice modrému světlu (slunce, 10 000 lux lampy) spouští kortizol a připravuje tělo na výkon.</p> <h3 class="text-2xl text-neuro-focus mb-3" >Večerní Útlum</h3> <p class="text-slate-300 mb-6" >Po západu slunce byste měli minimalizovat modré světlo (telefony, LED). MONO se tomu přizpůsobuje automatickým přepnutím do "Neuro-Rest"(jantarového) módu po 18. hodině, což podporuje produkci melatoninu.</p> `,
                en: ` <h2 class="text-3xl text-white font-bold mb-4" >Light as a Zeitgeber</h2> <p class="text-slate-300 mb-6" >Light is the main synchronizer of our internal clock. Morning exposure to blue light (sun, 10,000 lux lamps) triggers cortisol and prepares the body for performance.</p> <h3 class="text-2xl text-neuro-focus mb-3" >Evening Wind-down</h3> <p class="text-slate-300 mb-6" >After sunset, you should minimize blue light (phones, LEDs). MONO adapts to this by automatically switching to "Neuro-Rest" (amber) mode after 6 PM, supporting melatonin production.</p> `
            },
            date: { cs: '2. Března 2025', en: 'March 2, 2025' },
            readTime: { cs: '5 min', en: '5 min' }
        },
        {
            id: 3,
            title: { cs: 'Technika Non-Sleep Deep Rest', en: 'Non-Sleep Deep Rest Technique' },
            excerpt: {
                cs: 'NSDR protokoly Andrewa Hubermana pro obnovu dopaminu za 10 minut.',
                en: 'Andrew Huberman\'s NSDR protocols for dopamine recovery in 10 minutes.'
            },
            image: 'assets/nsdr_calm_abstract_1766494191469.png',
            content: {
                cs: ` <h2 class="text-3xl text-white font-bold mb-4" >Co je NSDR?</h2> <p class="text-slate-300 mb-6" >Non-Sleep Deep Rest (NSDR) nebo Yoga Nidra je stav mezi bděním a spánkem. Umožňuje mozku "resetovat" se a urychluje neuroplasticitu po intenzivním učení nebo práci.</p> <h3 class="text-2xl text-neuro-focus mb-3" >Jak na to?</h3> <ul class="list-disc pl-6 text-slate-300 space-y-2" > <li>Najděte si klidné místo a lehněte si.</li> <li>Soustřeďte se na dech a skenování těla (body scan).</li> <li>Vizualizujte uvolnění napětí v každé části těla.</li> </ul> `,
                en: ` <h2 class="text-3xl text-white font-bold mb-4" >What is NSDR?</h2> <p class="text-slate-300 mb-6" >Non-Sleep Deep Rest (NSDR) or Yoga Nidra is a state between wakefulness and sleep. It allows the brain to "reset" and accelerates neuroplasticity after intensive learning or work.</p> <h3 class="text-2xl text-neuro-focus mb-3" >How to do it?</h3> <ul class="list-disc pl-6 text-slate-300 space-y-2" > <li>Find a quiet place and lie down.</li> <li>Focus on your breath and body scan.</li> <li>Visualize releasing tension in every part of your body.</li> </ul> `
            },
            date: { cs: '10. Března 2025', en: 'March 10, 2025' },
            readTime: { cs: '4 min', en: '4 min' }
        },
        {
            id: 4,
            title: { cs: 'Harmonie biorytmů', en: 'Biorhythm Harmony' },
            excerpt: {
                cs: 'Biologické hodiny v akci: Jak ovládnout cirkadiánní a ultradiánní cykly pro špičkový výkon i regeneraci.',
                en: 'Biological clocks in action: How to master circadian and ultradian cycles for peak performance and regeneration.'
            },
            image: 'assets/biorhythm_harmony.png',
            content: {
                cs: ` <h2 class="text-3xl text-white font-bold mb-4" >Biologické rytmy</h2> <p class="text-slate-300 mb-6" >V moderní digitální éře, kde je pozornost nejcennější komoditou, často zapomínáme, že náš mozek a tělo nefungují lineárně, ale v rytmických vlnách. Pochopení těchto vnitřních hodin – konkrétně cirkadiánních a ultradiánních cyklů – není jen biologickou zajímavostí, ale nezbytným nástrojem pro každého, kdo chce dosahovat vysoké produktivity bez rizika vyhoření.</p> <h2 class="text-3xl text-white font-bold mb-4" >Cirkadiánní rytmus: Váš 24hodinový dirigent</h2> <p class="text-slate-300 mb-6" >Cirkadiánní rytmus (z latinského circa dies – přibližně den) je biologický cyklus trvající 20–28 hodin. Je řízen suprachiasmatickými jádry (SCN) v hypothalamu, která fungují jako centrální biologické hodiny. Tyto hodiny synchronizují klíčové funkce jako hladinu hormonů, tělesnou teplotu a kognitivní výkon.</p> <ul class="list-disc pl-6 text-slate-300 space-y-2 mb-6" > <li><strong>Ranní aktivace:</strong> Po probuzení dochází k přirozenému nárůstu kortizolu, který podporuje bdělost. Vystavení jasnému rannímu světlu slouží jako klíčový „zeitgeber“ (udavač času).</li> <li><strong>Kognitivní okna:</strong> První fáze (0–8 hodin po probuzení) je obvykle nejvhodnější pro hlubokou práci a úkoly náročné na pozornost.</li> <li><strong>Večerní zklidnění:</strong> S poklesem světla tělo začíná produkovat melatonin, který usnadňuje spánek. Expozice modrému světlu z obrazovek v noci tento proces blokuje.</li> </ul> <h2 class="text-3xl text-white font-bold mb-4" >Ultradiánní cykly: Tajemství 90minutových vln</h2> <p class="text-slate-300 mb-6" >Ultradiánní cykly (kratší než 24 hodin) řídí vaši energii v kratších úsecích. Nathaniel Kleitman popsal tzv. Basic Rest-Activity Cycle (BRAC), což jsou cykly trvající přibližně 90–110 minut.</p> <ul class="list-disc pl-6 text-slate-300 space-y-2 mb-6" > <li><strong>Vlna soustředění:</strong> Během první poloviny cyklu jsou mozkové vlny rychlejší, odpovídající vysokému soustředění.</li> <li><strong>Bod útlumu:</strong> Po zhruba 90 minutách dochází k vyčerpání neurotransmiterů. Mozek se přepíná do režimu útlumu.</li> <li><strong>Důležitost přestávek:</strong> Krátké, strukturované přestávky každých 90–120 minut mohou snížit riziko únavy až o 43 %.</li> </ul> <h2 class="text-3xl text-white font-bold mb-4" >Jak s rytmy pracovat</h2> <ol class="list-decimal pl-6 text-slate-300 space-y-2 mb-6" > <li><strong>Plánování podle chronotypu:</strong> Respektujte, zda jste „skřivan“ nebo „sova“.</li> <li><strong>Hluboká práce v blocích:</strong> Využívejte 90minutové úseky pro náročné projekty.</li> <li><strong>Využití technologií:</strong> Nástroje jako Brain.fm nebo Endel se mohou adaptovat na vaše rytmy.</li> <li><strong>Digitální a světelná hygiena:</strong> Omezte obrazovky před spaním pro stabilní kognitivní výkon zítra.</li> </ol> <blockquote class="border-l-4 border-neuro-focus pl-4 italic text-slate-400 my-6" > "Práce s vašimi biorytmy je jako plavba na otevřeném moři. Pokud své úsilí sladíte s rytmem vln, vynesou vás vpřed s minimální námahou." </blockquote> `,
                en: ` <h2 class="text-3xl text-white font-bold mb-4" >Biological Rhythms</h2> <p class="text-slate-300 mb-6" >In the modern digital era, where attention is the most valuable commodity, we often forget that our brains and bodies do not operate linearly, but in rhythmic waves. Understanding these internal clocks – specifically circadian and ultradian cycles – is not just biological trivia, but an essential tool for anyone wanting to achieve high productivity without burnout.</p> <h2 class="text-3xl text-white font-bold mb-4" >Circadian Rhythm: Your 24-Hour Conductor</h2> <p class="text-slate-300 mb-6" >The circadian rhythm (from Latin circa dies – about a day) is a biological cycle lasting 20–28 hours. It is controlled by the suprachiasmatic nucleus (SCN) in the hypothalamus, which acts as the central biological clock. This clock synchronizes key functions like hormone levels, body temperature, and cognitive performance.</p> <ul class="list-disc pl-6 text-slate-300 space-y-2 mb-6" > <li><strong>Morning Activation:</strong> Upon waking, there is a natural spike in cortisol, promoting alertness. Exposure to bright morning light serves as a key “zeitgeber” (time giver).</li> <li><strong>Cognitive Windows:</strong> The first phase (0–8 hours after waking) is usually best for deep work and attention-demanding tasks.</li> <li><strong>Evening Calm:</strong> As light fades, the body begins producing melatonin, facilitating sleep. Exposure to blue light from screens at night blocks this process.</li> </ul> <h2 class="text-3xl text-white font-bold mb-4" >Ultradian Cycles: The Secret of 90-Minute Waves</h2> <p class="text-slate-300 mb-6" >Ultradian cycles (shorter than 24 hours) govern your energy in shorter bursts. Nathaniel Kleitman described the so-called Basic Rest-Activity Cycle (BRAC), which are cycles lasting approximately 90–110 minutes.</p> <ul class="list-disc pl-6 text-slate-300 space-y-2 mb-6" > <li><strong>Focus Wave:</strong> During the first half of the cycle, brain waves are faster, corresponding to high focus.</li> <li><strong>Slump Point:</strong> After roughly 90 minutes, neurotransmitters are depleted. The brain switches to a rest mode.</li> <li><strong>Importance of Breaks:</strong> Short, structured breaks every 90–120 minutes can reduce fatigue risk by up to 43%.</li> </ul> <h2 class="text-3xl text-white font-bold mb-4" >How to Work with Rhythms</h2> <ol class="list-decimal pl-6 text-slate-300 space-y-2 mb-6" > <li><strong>Chronotype Planning:</strong> Respect whether you are a "lark" or an "owl".</li> <li><strong>Deep Work Blocks:</strong> Use 90-minute segments for demanding projects.</li> <li><strong>Tech Leverage:</strong> Tools like Brain.fm or Endel can adapt to your rhythms.</li> <li><strong>Digital & Light Hygiene:</strong> Limit screens before bed for stable cognitive performance tomorrow.</li> </ol> <blockquote class="border-l-4 border-neuro-focus pl-4 italic text-slate-400 my-6" > "Working with your biorhythms is like sailing on the open sea. If you align your effort with the rhythm of the waves, they will carry you forward with minimal effort." </blockquote> `
            },
            date: { cs: '31. Prosince 2025', en: 'December 31, 2025' },
            readTime: { cs: '7 min', en: '7 min' }
        }];

        function renderBlogList() {
            const list = document.getElementById('articleList');
            // Remove existing classes to reset layout if needed, though direct style/class manipulation on the parent is limited here.
            // Assuming articleList is a div we can style. Ideally we'd ensure the parent has grid classes.
            // Let's forcegrid classes on the container if not present, or wrap in grid.
            // The HTML structure shows 'div#articleList.space-y-6', so we should change that class via JS or just ensure the innerHTML structure is robust.
            // Better approach: Make the container a grid.

            list.className = "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"; // Apply grid layout directly

            list.innerHTML = ARTICLES.slice().reverse().map(art => `
                                            <div onclick="openArticle(${art.id})" class="bg-slate-800/40 rounded-2xl border border-slate-700/50 hover:border-neuro-focus/50 hover:bg-slate-800/80 transition-all cursor-pointer group overflow-hidden flex flex-col h-full hover:shadow-2xl hover:shadow-neuro-focus/10 transform hover:-translate-y-1">
                                                <div class="h-48 overflow-hidden relative">
                                                    <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent z-10 opacity-60"></div>
                                                    <img src="${art.image}" alt="${art.title[currentLang]}" class="w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-700">
                                                    <div class="absolute bottom-3 left-4 z-20 flex gap-2">
                                                        <span class="text-neuro-focus text-xs font-bold font-mono bg-slate-900/80 backdrop-blur-sm px-2 py-1 rounded border border-neuro-focus/30">${art.date[currentLang]}</span>
                                                    </div>
                                                </div>
                                                <div class="p-6 flex-1 flex flex-col">
                                                    <div class="flex justify-between items-start mb-3">
                                                        <span class="text-slate-500 text-xs flex items-center gap-1 bg-slate-900/50 px-2 py-1 rounded-full">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                                            ${art.readTime[currentLang]} ${t('blog.readTime')}
                                                        </span>
                                                    </div>
                                                    <h2 class="text-xl font-bold text-white mb-3 group-hover:text-neuro-focus transition-colors line-clamp-2">${art.title[currentLang]}</h2>
                                                    <p class="text-slate-400 text-sm leading-relaxed line-clamp-3 mb-4 flex-1">${art.excerpt[currentLang]}</p>
                                                    <div class="flex items-center text-neuro-focus text-sm font-medium opacity-0 group-hover:opacity-100 transition-opacity transform translate-y-2 group-hover:translate-y-0">
                                                        ${t('blog.readArticle')} <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" /></svg>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('');
        }

        window.openArticle = (id) => {
            const art = ARTICLES.find(a => a.id === id);
            if (!art) return;

            document.getElementById('articleList').classList.add('hidden');
            const detail = document.getElementById('articleDetail');
            detail.classList.remove('hidden');

            document.getElementById('articleContent').innerHTML = `
                                            <div class="mb-6">
                                                <button onclick="document.getElementById('backToArticlesBtn').click()" class="text-neuro-focus hover:text-white transition-colors flex items-center gap-2 mb-4">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                                                    ${t('blog.back')}
                                                </button>
                                                <h1 class="text-4xl md:text-5xl font-bold text-white mb-8">${art.title[currentLang]}</h1>
                                                <div class="flex gap-4 text-slate-500 mb-12 border-b border-slate-800 pb-8">
                                                    <span>${art.date[currentLang]}</span><span>•</span><span>${art.readTime[currentLang]} ${t('blog.readTime')}</span>
                                                </div>
                                            </div>
                                            <div class="article-content prose prose-invert max-w-none">
                                                ${art.content[currentLang]}
                                            </div>
                                        `;
            window.scrollTo(0, 0);
        }

            ;

        document.getElementById('backToArticlesBtn').addEventListener('click', () => {
            document.getElementById('articleDetail').classList.add('hidden');
            document.getElementById('articleList').classList.remove('hidden');
        });

        // Navigation Logic
        function switchView(viewName) {
            const app = document.querySelector('main'); // The main app container
            const blog = document.getElementById('blogSection');
            const updates = document.getElementById('updatesSection');
            const feedback = document.getElementById('feedbackSection');

            const navFocus = document.getElementById('navFocusBtn');
            const navBlog = document.getElementById('navBlogBtn');
            const navUpdates = document.getElementById('navUpdatesBtn');
            const navFeedback = document.getElementById('navFeedbackBtn');

            // Reset all content
            app.classList.add('hidden');
            blog.classList.add('hidden');
            updates.classList.add('hidden');
            if (feedback) feedback.classList.add('hidden');

            // Reset Tabs
            [navFocus, navBlog, navUpdates, navFeedback].forEach(btn => {
                if (!btn) return;
                btn.classList.add('text-slate-400', 'hover:text-white', 'hover:bg-white/5');
                btn.classList.remove('bg-neuro-focus', 'text-white', 'shadow-[0_0_20px_rgba(14,165,233,0.3)]');
            });

            if (viewName === 'BLOG') {
                blog.classList.remove('hidden');
                activateTab(navBlog);
                renderBlogList();
            } else if (viewName === 'UPDATES') {
                updates.classList.remove('hidden');
                activateTab(navUpdates);
            } else if (viewName === 'FEEDBACK') {
                if (feedback) feedback.classList.remove('hidden');
                activateTab(navFeedback);
                renderFeedback();
            } else {
                app.classList.remove('hidden');
                activateTab(navFocus);
            }
        }

        function activateTab(btn) {
            if (!btn) return;
            btn.classList.remove('text-slate-400', 'hover:text-white', 'hover:bg-white/5');
            btn.classList.add('bg-neuro-focus', 'text-white', 'shadow-[0_0_20px_rgba(14,165,233,0.3)]');
        }

        // Nav Listeners
        document.getElementById('navFocusBtn').addEventListener('click', () => switchView('APP'));
        document.getElementById('navBlogBtn').addEventListener('click', () => switchView('BLOG'));
        document.getElementById('navUpdatesBtn').addEventListener('click', () => switchView('UPDATES'));
        document.getElementById('navFeedbackBtn').addEventListener('click', () => switchView('FEEDBACK'));

        const fbForm = document.getElementById('feedbackForm');
        if (fbForm) fbForm.addEventListener('submit', addFeedback);

        // Initialize
        renderThoughts();
        renderSessionLog(); // init 00:00

        // --- Winter Mode: Snow Generation ---
        function createSnowflakes() {
            const container = document.getElementById('snow-container');
            if (!container) return;
            const snowflakeCount = 50;

            for (let i = 0; i < snowflakeCount; i++) {
                const flake = document.createElement('div');
                flake.classList.add('snowflake');
                flake.textContent = '❄';

                // Random positioning and animation properties
                const left = Math.random() * 100; // 0-100%
                const duration = 5 + Math.random() * 10; // 5-15s
                const delay = Math.random() * 5; // 0-5s
                const size = 0.5 + Math.random() * 1; // 0.5-1.5em

                flake.style.left = left + 'vw';
                flake.style.animationDuration = duration + 's';
                flake.style.animationDelay = -delay + 's';
                flake.style.fontSize = size + 'em';
                flake.style.opacity = (Math.random() * 0.5 + 0.3).toString();

                container.appendChild(flake);
            }
        }

        createSnowflakes();

        // Prevent accidental reload
        window.addEventListener('beforeunload', (e) => {
            if (state.phase !== 'PREP') {
                e.preventDefault();
                e.returnValue = '';
            }
        });

        // Mobile Menu Logic
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
        let isMobileMenuOpen = false;

        if (mobileMenuBtn && mobileMenuOverlay) {
            mobileMenuBtn.addEventListener('click', () => {
                isMobileMenuOpen = !isMobileMenuOpen;
                if (isMobileMenuOpen) {
                    mobileMenuOverlay.classList.remove('hidden');
                    // Small delay to allow display:flex to apply before opacity transition
                    setTimeout(() => mobileMenuOverlay.classList.remove('opacity-0'), 10);
                } else {
                    mobileMenuOverlay.classList.add('opacity-0');
                    setTimeout(() => mobileMenuOverlay.classList.add('hidden'), 300);
                }
            });

            // Close mobile menu on link click
            const closeMobileMenu = () => {
                isMobileMenuOpen = false;
                mobileMenuOverlay.classList.add('opacity-0');
                setTimeout(() => mobileMenuOverlay.classList.add('hidden'), 300);
            };

            const mobNavIds = ['mobNavFocus', 'mobNavBlog', 'mobNavUpdates', 'mobNavFeedback'];
            const navBtnIds = ['navFocusBtn', 'navBlogBtn', 'navUpdatesBtn', 'navFeedbackBtn'];

            mobNavIds.forEach((mobId, idx) => {
                const btn = document.getElementById(mobId);
                if (btn) {
                    btn.addEventListener('click', () => {
                        closeMobileMenu();
                        document.getElementById(navBtnIds[idx]).click();
                    });
                }
            });
        }

    </script>
</body>

</html>